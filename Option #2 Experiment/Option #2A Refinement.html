<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ConversationalRetrievalChain + VectorStoreRetrieverMemory – TAXA Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../millerlogo.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tiktoken-splitter" id="toc-tiktoken-splitter" class="nav-link active" data-scroll-target="#tiktoken-splitter">Tiktoken Splitter</a></li>
  <li><a href="#faiss-vectorstore" id="toc-faiss-vectorstore" class="nav-link" data-scroll-target="#faiss-vectorstore">FAISS Vectorstore</a></li>
  <li><a href="#contextual-compression" id="toc-contextual-compression" class="nav-link" data-scroll-target="#contextual-compression">Contextual compression</a>
  <ul class="collapse">
  <li><a href="#adding-contextual-compression-with-an-llmchainextractor" id="toc-adding-contextual-compression-with-an-llmchainextractor" class="nav-link" data-scroll-target="#adding-contextual-compression-with-an-llmchainextractor">Adding contextual compression with an LLMChainExtractor</a></li>
  </ul></li>
  <li><a href="#prompting" id="toc-prompting" class="nav-link" data-scroll-target="#prompting">Prompting</a></li>
  <li><a href="#conversationalretrievalchain-with-map_reduce" id="toc-conversationalretrievalchain-with-map_reduce" class="nav-link" data-scroll-target="#conversationalretrievalchain-with-map_reduce">ConversationalRetrievalChain with map_reduce</a></li>
  <li><a href="#conversationalretrievalchain-similarity-search-w-conversationbuffermemory" id="toc-conversationalretrievalchain-similarity-search-w-conversationbuffermemory" class="nav-link" data-scroll-target="#conversationalretrievalchain-similarity-search-w-conversationbuffermemory"><strong><em>ConversationalRetrievalChain Similarity Search w/ ConversationBufferMemory </em></strong></a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/Miller-Library/taxa_webV2/blob/main/Option #2 Experiment/Option #2A Refinement.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/Miller-Library/taxa_webV2/blob/main/Option #2 Experiment/Option #2A Refinement.ipynb" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/Miller-Library/taxa_webV2/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ConversationalRetrievalChain + VectorStoreRetrieverMemory</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="882a266b" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openai</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys, pathlib, fitz</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.chains <span class="im">import</span> ConversationalRetrievalChain</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.document_loaders <span class="im">import</span> PyMuPDFLoader</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.text_splitter <span class="im">import</span> TokenTextSplitter</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.embeddings.openai  <span class="im">import</span> OpenAIEmbeddings</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.vectorstores <span class="im">import</span> FAISS</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.retrievers <span class="im">import</span> ContextualCompressionRetriever</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.retrievers.document_compressors <span class="im">import</span> LLMChainExtractor</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.retrievers.document_compressors <span class="im">import</span> LLMChainFilter</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.chat_models <span class="im">import</span> ChatOpenAI</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.memory <span class="im">import</span> ConversationBufferMemory</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain <span class="im">import</span> PromptTemplate</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.chains.conversational_retrieval.prompts <span class="im">import</span> CONDENSE_QUESTION_PROMPT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3f71f89f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv, find_dotenv</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> load_dotenv(find_dotenv()) <span class="co"># read local .env file</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>openai.api_key  <span class="op">=</span> os.environ[<span class="st">'OPENAI_API_KEY'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7a61a18b" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_citations(page_text):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># List of variations of "citations" to check for</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    citation_variations <span class="op">=</span> [<span class="st">"Citations"</span>, <span class="st">"Literature Cited"</span>, <span class="st">"Literature Citations"</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> variation <span class="kw">in</span> citation_variations:</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> variation <span class="kw">in</span> page_text:</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_citation_pages(pdf_path):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> fitz.<span class="bu">open</span>(pdf_path)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    non_citation_pages <span class="op">=</span> []</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> page_num <span class="kw">in</span> <span class="bu">range</span>(doc.page_count):</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        page <span class="op">=</span> doc[page_num]</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        page_text <span class="op">=</span> page.get_text()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> has_citations(page_text):</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            non_citation_pages.append(page_num)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a new PDF with only non-citation pages</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    new_pdf <span class="op">=</span> fitz.<span class="bu">open</span>()</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> page_num <span class="kw">in</span> non_citation_pages:</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        new_pdf.insert_pdf(doc, from_page<span class="op">=</span>page_num, to_page<span class="op">=</span>page_num)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_pdf</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>input_pdf_path <span class="op">=</span> <span class="st">'./hms/fhl_2014_Charifson_34622 (1).pdf'</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new PDF with citation pages removed</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>new_pdf <span class="op">=</span> remove_citation_pages(input_pdf_path)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the new PDF to 'output.pdf'</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>output_pdf_path <span class="op">=</span> <span class="st">'output.pdf'</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>new_pdf.save(output_pdf_path)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># new_pdf.close()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fab450f8" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_text_from_pdf(pdf_path):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> fitz.<span class="bu">open</span>(pdf_path)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">""</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> page <span class="kw">in</span> doc:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        text <span class="op">+=</span> page.get_text()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    doc.close()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace 'output.pdf' with the path to the PDF you created with citation pages removed</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>new_pdf_path <span class="op">=</span> <span class="st">'output.pdf'</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract text from the new PDF</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>new_pdf_text <span class="op">=</span> extract_text_from_pdf(new_pdf_path)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you can manipulate the extracted text or perform any other actions as needed</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, you can print the extracted text:</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_pdf_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Charifson 1 
 
Snail Predation by Hemigrapsus nudus and Hemigrapsus oregonensis: Sex and Species 
Differences in Chela Size. 
 
David Charifson1,2 
 
Marine Invertebrate Zoology 
Summer 2014 
 
 
 
 
1 Friday Harbor Laboratories, University of Washington, Friday Harbor, WA 98250 
2 Department of Ecology and Evolution, Stony Brook University, Stony Brook, NY 11794-5245 
 
 
 
 
Contact information: 
David Charifson 
Department of Ecology and Evolution 
Stony Brook University 
650 Life Sciences Building 
Stony Brook, NY 11794-5245 
David.charifson@stonybrook.edu  
 
 
 
 
Keywords: Hemigrapsus nudus, Hemigrapsus orogenensis, Littorina scutulata, Lacuna vincta, 
predation, sexual dimorphism, character displacement  
 
 
Charifson 2 
 
Abstract: 
 
The relationship between propus size and use of snails as prey in sympatric populations 
of Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal 
width increases with body size in a predictable manner in male and female crabs of both species. 
Sexual dimorphism of propal height and width relationships in both shore crabs is apparent, but 
there was no detectible difference in chela size between H. nudus and H. oregonensis. The lack 
of difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is 
no character displacement in this trait. Both species of crabs showed a strong feeding preference 
for the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely 
due to the ease of consumption. There were no differences in snail consumption rates between 
male and female H. nudus of similar propal heights, mostly due to high feeding variation among 
individual crabs.  
 
Introduction: 
 
A multitude of species coexist in the marine intertidal environment. Closely related 
species may be sympatric and compete for resources, such as food. Two species of shore crab, 
Hemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry 
in the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. 
Species in sympatry may exhibit character displacement, the exaggeration of morphological or 
behavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. 
nudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in 
finer sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still 
considerable habitat overlap between these two species; the underside of a single rock may have 
Charifson 3 
 
roughly equal abundances of the two crab species (personal observation). The size of the chela 
may differ, which could allow the crabs to differentiate in food resource utilization. 
Both species are omnivores that eat algae and small invertebrates, including snails 
(Behrens Yamada and Boulding 1996). The two shore crab species are known to eat Littorina 
sitkana (Philippi 1846) and Littorina scutulata (Gould 1849), which also occur in the rocky 
intertidal zone (Behrens Yamada and Boulding 1996). Li. scutulata moves upshore in response 
to the presence of H. nudus and crushed conspecifics, where H. nudus density is lower (Keppel 
and Scrosati 2004). This suggests that H. nudus represents an ecologically significant predation 
threat to littorines.  
 
The thick shelled littorines are difficult prey for both H. nudus and H. oregonensis as 
neither crab species is a molluscivore specialists; they typically scrape or pick algae and softer 
invertebrates off rocks using their chelae (Behrens Yamada and Boulding 1996). Behrens 
Yamada and Boulding (1998) found that large H. nudus were capable of consuming Li. sitkana 
that were less than 8 mm in length, but had only a 37% success rate of consuming snails with 
lengths between 5.5-7 mm .  
I sought to investigate differences in propus size between between males and females of 
these two crab species. The size of the propus of the chela is positively correlated with the 
amount of force that can be produced due to greater musculature (Behrens Yamada and Boulding 
1998). A significant difference in propus size between the two species would suggest that further 
testing of character displacement may be warranted. A disparity in propus size to body size 
between male and female crabs might result in different feeding rates and shell breaking 
capabilities. I devised a test of preference by varying snail shell strength within the same size 
class. The snail species Li. scutulata and Lacuna vincta (Montagu 1803) are both in the family 
Charifson 4 
 
Littorinidae and have similar shell shape but different shell thickness. Lacuna vincta has a 
thinner, more fragile shell and is likely to be preferred as prey by shore crabs. I also hypothesize 
that, if chela size is held constant, female crabs will have greater snail consumption rates than 
male crabs. Female crabs with claws equivalent to males have a larger body mass,are likely to 
have greater metabolic need, and are less easily satiated. 
 
Study System: 
 
All specimens were collected on San Juan Island, Washington.  Two shore crabs (clade: 
Brachyura: Family Grapsidae), Hemigrapsus oregonensis  and Hemigrapsus nudus were 
collected in the intertidal adjacent to the Friday Harbor Laboratories dock. These closely related 
crabs are morphologically similar, but can be distinguished by the presence of purple spots on 
the cheliped of H. nudus and abundant setae on the pereopods of H. oregonensis (Kozloff 1987). 
Lacuna vincta, in the Class Gastropoda and Family Littoridae, were collected at False Bay and 
Dead Man Cove. Littorina scutulata, in the Class Gastropoda and Family Littoridae, were 
collected from the rocky intertidal zone of Fourth of July Beach.  
 
Materials and Methods: 
Morphometrics 
 
Male and females of H. oregonensis and H. nudus were measured with digital calipers 
(0.1 mm). Each crab was measured for carapace width, propal height and propal width. Carapace 
width was taken at the widest part of the carapace. Propal height was measured at the highest 
vertical distance along the propus. Propal width was measured perpendicular to propal height, 
from the left to right sides of the propus. All claw measurements were made on the left cheliped. 
Charifson 5 
 
If there was a size disparity between the left and right claws due to regeneration of a lost claw, 
the crab was excluded from the study. Ratios of carapace width:propal height (CW:PH) and 
carapace width:propal width (CW:PW) were calculated.  
 
Crab Feeding Preference 
 
Three female (Fe1, Fe2, Fe3) and three male (Ma1, Ma2, Ma3) crabs of H. nudus with 
propal heights between 5-6 mm were placed in small flow-through containers. Five L. scutulata 
and five L. vincta with shell lengths between 4-6 mm were added to each container. The ranges 
of crab propal height and snail shell length were chosen based on prior studies to ensure that the 
crabs were capable of feeding on the hard-shelled L. scutulata (Behrens Yamada and Boulding 
1998). H. oregonensis was excluded due to the rarity of female crabs of that species within the 
range of appropriate propal heights. After approximately 15 hours the number of L. scutulata and 
L. vincta consumed was counted. Three trials were conducted for each crab. 
Snail Consumption by Hemigrapsus nudus 
 
The crabs from the preference experiment were given five of each snail in each trial. 
After 1.5 to 3 hours the number of snails consumed was counted and converted to a consumption 
rate (snails consumed/hour). A total of eight feeding trials were conducted.  
 
Statistical Analysis 
 
For the morphometric analysis, crabs were divided into four groups based on sex and 
species. Standardized major axis regression was used to determine the relationship between crab 
morphometric parameters. Arcsin transformations were used to correct for non-normality (Sokol 
and Rohlf 2011). Differences in CW:PH and CW:PW were analyzed using a two-way ANOVA 
Charifson 6 
 
with factors: Sex and Species. Prey selection by H. nudus was analyzed using G-tests for each 
individual that consumed snails. An one-way ANOVA was used to determine differences in snail 
consumption rates by H. nudus.  
 
Results: 
Morphometrics: 
 
Carapace width was a good predictor of both propal height (Figure 1, Table 1A) and 
propal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was 
less variation in the relationship between carapace width and propal height than with propal 
width.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A 
significant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, 
45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for 
CW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant 
sex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 
= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species 
respectively.  
 
Crab Feeding Preference:  
 
Expected values for both the number of L. scutulata and L. vincta consumed for the G-
test are 0.5 multiplied by the total number of snails consumed by each individual crab. G-tests 
for individual H. nudus that eat snails were all significant at p &lt; 0.001 with 1 degree of freedom 
(See Table 2 for statistical summary). The three crabs that did not eat either L. scutulata or L. 
vincta could not be tested for feeding preference.  
Charifson 7 
 
 
Snail Consumption by Hemigrapsus nudus 
 
No significant difference in crab feeding rate (snails consumed/hour) was found (F2, 21 = 
2.52, p = 0.104) among individual H. nudus that fed on snails during the course of the 
consumption experiment (Figure 5). Fe2  ate snails at a rate of 0.59±0.53 snails/hour (variance is 
standard deviation), Ma1 feeding rate was 0.24±0.31 snails/hour, and Ma2 had a feeding rate of 
0.80±0.38 snails/hour. Individuals Fe1, Fe3 and Ma3 did not consume any snails during the 
course of the experiment.  
 
Discussion: 
 
A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus 
and Hemigrapsus orogenensis. The variance in propal height or propal width explained by 
carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for 
propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela 
size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width 
respectively. The R2 values for propal width regressed against carapace width were consistently 
lower than propal height regressed against carapace width across species and sexes (Table 1). In 
general the ability of carapace width to explain the variance in chela size parameters (i.e.: R2 
values) was greater in females of both crab species (Table 1, Figures 1 and 2). Males may have 
more variation in claw size due to trade-offs between claw size and factors like feeding 
efficiency or resource allocation. Trade-offs relating to chela size are found in fiddler crabs, 
which exhibit extreme sexual dimorphism. Fiddler crabs have a trade-off between the intrasexual 
competition and intersexual signaling functions of the dimorphic claw (Swanson et al. 2013). 
Charifson 8 
 
This is not to say that the particular trade-offs in fiddler crabs case are analogous to that of 
Hemigrapsus, since both claws in the two shore crabs in this study are used in feeding.  
Sexual dimorphism in chela size, which is readily apparent to the eye in both 
Hemigrapsus nudus and Hemigrapsus oregonensis, was detected statistically (Figures 3 and 4). 
The two-way ANOVA with factors sex and species did not show a significant species effect, 
suggesting that the claws of both shore crabs produce roughly the same force and are 
functionally equivalent (Behrens Yamada and Boulding 1998). The lack of morphological 
difference in the size of the chelae between the crab species removes the possibility of character 
displacement in the trait. It should be noted that this study was not designed to test for character 
displacement, but to determine if this would be an interesting question for future investigations. 
To make a compelling case for character displacement it is necessary to compare multiple 
sympatric and allopatric populations with similar abiotic and biotic conditions (Stuart and Losos 
2013). Also it must be demonstrated that the trait differs due to genetic differences between 
sympatric and allopatric populations, that the differences between the populations are not due to 
species sorting, that the morphological trait is correlated to differences in resource use between 
the two sympatric species, and that the similar phenotype in allopatric populations compete for 
the same resources (Stuart and Losos 2013). The tendency of H. nudus to occupy the upper 
intertidal zone (Sliger 1987), despite considerable overlap with H. oregonensis, may provide 
enough differential resource use to prevent exclusion in sympatry. Desiccation tolerance may be 
a better trait to test for character displacement in these shore crabs.  
H. nudus males and females clearly preferred to eat the thinner shelled Lacuna vincta 
(Table 2). During the course of the feeding preference experiment all the crabs that ate snails 
consumed L. vincta exclusively. However, one Littorina scutuala was eaten by H. nudus when 
Charifson 9 
 
determining consumption rates. The six crabs were chosen because their claws were of 
appropriate size to eat littorines with shell length between 4-6 mm, yet only half of the crabs ate 
these snails. This could be due to insufficient time to acclimate H. nudus to lab conditions and 
possibly reduced feeding associated with molting. Male snow crabs, Chionoecetes opilio, were 
shown to cease feeding 3-6 weeks before and 3-4 weeks after molting (O’Halloran and O’Dor 
1988).  
It was my original intention to test for sex differences in consumption rates, but this was 
not possible as I could not collect many crabs of the appropriate claw size for gastropod feeding 
and many of the crabs I did collect did not feed. There were no statistically significant 
differences in consumption rates (snails eaten/hour) among the three feeding H. nudus. These 
individuals had highly variable feeding rates, mostly due to trials in which the crab did not feed. 
Sylvia Behrens Yamada and Elizabeth Boulding (1998) found that H. nudus consumed 1.8 
Littorina. sitkana/individual crab/day. In my study crabs fed on 13.03 Lacuna vincta/individual 
crab/ day. The greater consumption rate in my study is likely due to the easily breakable shells of 
La. vincta.  
The findings of this study suggest that there is no potential for character displacement of 
chela size in the sympatric H. nudus and H. oregonensis. This leaves the question of species co-
occurrence open to other possibilities. H. nudus has a strong preference for La. vincta, but it 
seems as if there have been no studies that show predation on La. vincta in the field. It should be 
noted that H. nudus and La. vincta usually occupy different portions of the intertidal and may 
have little contact with each other, unlike the relationship between H. nudus and Li. scutulata. 
There is some potential for overlap in the winter when La. vincta migrates up shore. Although no 
differences in consumption rates between male and female H. nudus were found, this might be 
Charifson 10 
 
due to logistical issues surrounding the experimental design and little replication. Future studies 
should include more crabs, the exclusion of non-feeding crabs, and trial periods with longer time 
intervals. Additionally, any subsequent study should utilize multivariate and geometric 
morphometric methods to quantify claw shape instead of using ratios, as two similar ratios may 
have different shape.  
 
Acknowledgements: 
 
I would like to thank Dianna Padilla, Michael LaBarbera, and Kevin Turner for advice 
relating to the experimental design of this study. I would also like to thank the director and staff 
of Friday Harbor Laboratories for use of facilities and permission to collect organisms. Friday 
Harbor Laboratories, The Libbie Hyman Scholarship, Society for Integrative and Comparative 
Biology, and the Stony Brook Department of Ecology and Evolution provided financial support 
and have my gratitude.  
 
 
 
 
 
 
 
 
 
 
Charifson 12 
 
Swanson, B. O., George, M. N., Anderson, S. T., and Christy, J. H. 2013. Evolutionary variation
 
in the mechanics of fiddler crab claws. BMC Evolutionary Biology 13: 137. 
 
 
 
 
 
 
 
 
 
Charifson 13 
 
Table 1: SMA regressions of carapace width and propus measures.  
A) The relationship between carapace width and propal height. x is carapace width and y is 
propal height. B) The relationship between carapace width and propal height. x is carapace width 
and y is propal width.  
 
 
 
SMA Regression  
 
A 
 
N 
Carapace Width vs Propal Height  
R2 
 
Female H. nudus 
13 
y = 0.273*x - 0.678 
0.976 
 
Male H. nudus 
13 
y = 0.311*x - 1.385 
0.868 
 
Female H. oregonensis 
9 
y = 0.351*x - 0.833 
0.894 
 
Male H. oregonensis 
14 
y = 0.39*x - 1.149 
0.693 
 
 
 
 
 
 
 
 
SMA Regression  
 
B 
 
N 
Carapace Width vs Propal Width  
R2 
 
Female H. nudus 
13 
y = 0.157*x - 0.386 
0.927 
 
Male H. nudus 
13 
y = 0.209*x - 1.288 
0.859 
 
Female H. oregonensis 
9 
y = 0.175*x + 0.037 
0.724 
 
Male H. oregonensis 
14 
y = 0.244*x - 0.688 
0.534 
 
 
Charifson 14 
 
Table 2: Size and prey preference in H. nudus.  
Size parameters of experimental Hemigrapsus nudus and number of prey consumed in 24 hour 
intervals (three trials). Crabs Fe1, Fe3, and Ma3 did not feed on snails and were not testable (NT) 
for preference. 
Individual 
Carapace 
Width (mm) 
Propal 
Height (mm) 
Number of 
Lacuna vincta 
consumed 
Number of 
Littorina scutulata 
consumed 
 
G 
 
p-value 
Fe1 
23.6 
5.9 
0 
0 
NT 
 
Fe2 
23.1 
5.5 
15 
0 
20.8 
p &lt; 0.001 
Fe3 
20.6 
5 
0 
0 
NT 
 
Ma1 
19.1 
5.4 
14 
0 
19.4 
p &lt; 0.001 
Ma2 
18.4 
5.4 
15 
0 
20.8 
p &lt; 0.001 
Ma3 
20.1 
6 
0 
0 
NT 
 
 
 
 
Charifson 15 
 
 
Figure 1: Relationship of carapace width and propal height in Hemigrapsus. Line of best fit from 
SMA regression. See Table 1A for descriptive statistics. A) Female H. nudus. B) Male H. nudus. 
C) Female H. oregonensis. D) Male H. oregonensis.  
 
 
 
Charifson 16 
 
 
Figure 2: Relationship of carapace width and propal width in Hemigrapsus.  
Line of best fit from SMA regression. See Table 1B for descriptive statistics. A) Female H. 
nudus. B) Male H. nudus. C)Female H. oregonensis. D) Male H. oregonensis.  
 
 
 
Charifson 17 
 
 
Figure 3: Differences in propal height:carapace width ratio between sex and species. 
The sex factor was statistically significant (F = 125.6. p &lt; 0.001), while the species factor was 
insignificant (F &gt; 0.01, p = 0.983). There was a significant interaction (F = 4.39, p = 0.042). 
Error bars represent standard error of the mean.  
 
 
 
0 
0.05 
0.1 
0.15 
0.2 
0.25 
0.3 
0.35 
H. nudus 
H. oregonensis 
Propal Height:Carapace Width 
Crab Species 
Female 
Male 
Charifson 18 
 
 
Figure 4: Differences in propal width:carapace width ratio between sex and species. 
The sex factor was statistically significant (F1,45 = 103.8. p &lt; 0.001), while the species factor was 
insignificant (F1,45  = 0.09, p = 0.764). There was a significant interaction (F1,45  = 7.19, p = 
0.01). Error bars represent standard error of the mean.  
 
 
 
0 
0.05 
0.1 
0.15 
0.2 
0.25 
H. nudus 
H. oregonensis 
Propal Widtht:Carapace Width 
Crab Species 
Female 
Male 
Charifson 19 
 
 
Figure 5: Consumption rates by individual H. nudus.  
Mean consumption rates (n = 8 trials) of 3 female (Fe1 to Fe3) and 3 male (Ma1 to Ma3) H. 
nudus. Crabs Fe1, Fe3, and Ma3 did not consume snails. The individuals that eat snails did not 
differ in their consumption rates (F2,21  = 2.52, p = 0.104). Error bars represent standard error of 
the mean.  
  
0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
1 
Fe1 
Fe2 
Fe3 
Ma1 
Ma2 
Ma3 
Mean Consumption Rate  
(Snails Consumed/Hour) 
Individual H. nudus 
</code></pre>
</div>
</div>
<section id="tiktoken-splitter" class="level2">
<h2 class="anchored" data-anchor-id="tiktoken-splitter">Tiktoken Splitter</h2>
<p>tiktoken is a fast byte pair encoding (BPE) tokenizer created by OpenAI.</p>
<p>We can use it to estimate tokens used. It will probably be more accurate for the OpenAI models.</p>
<ul>
<li>How the text is split: by character passed in</li>
<li>How the chunk size is measured: by tiktoken tokenizer</li>
</ul>
<p>Models don’t see text like humans, instead they see a sequence of numbers (known as tokens). Byte pair encoding (BPE) is a way of converting text into tokens. It has a couple desirable properties:</p>
<ul>
<li>It’s reversible and lossless, so you can convert tokens back into the original text</li>
<li>It works on arbitrary text, even text that is not in the tokeniser’s training data</li>
<li>It compresses the text: the token sequence is shorter than the bytes corresponding to the original text. On average, in practice, each token corresponds to about 4 bytes.</li>
<li>It attempts to let the model see common subwords. For instance, “ing” is a common subword in English, so BPE encodings will often split “encoding” into tokens like “encod” and “ing” (instead of e.g.&nbsp;“enc” and “oding”). Because the model will then see the “ing” token again and again in different contexts, it helps models generalise and better understand grammar.</li>
</ul>
<div id="a64d026b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tk_text_splitter <span class="op">=</span> TokenTextSplitter(chunk_size <span class="op">=</span> <span class="dv">800</span>, chunk_overlap <span class="op">=</span> <span class="dv">50</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>docs <span class="op">=</span> tk_text_splitter.split_text(new_pdf_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9e045ea3" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Initialize Embeddings</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>embeddings <span class="op">=</span> OpenAIEmbeddings()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="faiss-vectorstore" class="level2">
<h2 class="anchored" data-anchor-id="faiss-vectorstore">FAISS Vectorstore</h2>
<p>Faiss is a library for efficient similarity search and clustering of dense vectors. It contains algorithms that search in sets of vectors of any size, up to ones that possibly do not fit in RAM. It also contains supporting code for evaluation and parameter tuning.</p>
<div id="d72526c9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vector_store <span class="op">=</span> FAISS.from_texts(docs, embeddings).as_retriever(search_type <span class="op">=</span> <span class="st">"similarity"</span>, search_kwargs<span class="op">=</span> {<span class="st">"k"</span>: <span class="dv">3</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contextual-compression" class="level2">
<h2 class="anchored" data-anchor-id="contextual-compression">Contextual compression</h2>
<p>One challenge with retrieval is that usually you don’t know the specific queries your document storage system will face when you ingest data into the system. This means that the information most relevant to a query may be buried in a document with a lot of irrelevant text. Passing that full document through your application can lead to more expensive LLM calls and poorer responses.</p>
<p>Contextual compression is meant to fix this. The idea is simple: instead of immediately returning retrieved documents as-is, you can compress them using the context of the given query, so that only the relevant information is returned. “Compressing” here refers to both compressing the contents of an individual document and filtering out documents wholesale.</p>
<p>To use the Contextual Compression Retriever, you’ll need:</p>
<ul>
<li>a base Retriever</li>
<li>a Document Compressor</li>
</ul>
<p>The Contextual Compression Retriever passes queries to the base Retriever, takes the initial documents and passes them through the Document Compressor. The Document Compressor takes a list of Documents and shortens it by reducing the contents of Documents or dropping Documents altogether.</p>
<section id="adding-contextual-compression-with-an-llmchainextractor" class="level3">
<h3 class="anchored" data-anchor-id="adding-contextual-compression-with-an-llmchainextractor">Adding contextual compression with an LLMChainExtractor</h3>
<p>We wraped our base retriever with a ContextualCompressionRetriever. We’ll add an LLMChainExtractor, which will iterate over the initially returned documents and extract from each only the content that is relevant to the query.</p>
<div id="dfd177d6" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>llm <span class="op">=</span> ChatOpenAI(temperature<span class="op">=</span><span class="dv">0</span>, model_name<span class="op">=</span><span class="st">'gpt-3.5-turbo'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>compressor <span class="op">=</span> LLMChainExtractor.from_llm(llm)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>compression_retriever <span class="op">=</span> ContextualCompressionRetriever(base_compressor <span class="op">=</span> compressor,base_retriever<span class="op">=</span>vector_store)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="prompting" class="level2">
<h2 class="anchored" data-anchor-id="prompting">Prompting</h2>
<div id="5ce6c379" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>custom_template <span class="op">=</span> <span class="st">"""Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question. Please use a maximum of 4 sentences. If you do not know the answer reply with 'I am sorry'.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">1. SPECIES NAME: The scientific name (species name) of any plant, animal, fungus, alga or bacterium consists of two Latinized words. The first word is the name of the genus to which the organism belongs. The second word is the specific epithet or specific term of the species. Together, the genus plus the specific epithet make up the species name. The species name and scientific name are synonyms.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">2. HABITAT: A species habitat can be seen as the physical manifestation of its ecological niche.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">3. LOC: Name of any geographic location, like cities, countries, continents, districts etc.</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">Examples:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">1. Sentence: Strongylocentrotus fransiscanus and S. purpuratus were obtained from the subtidal and intertidal regions, respectively, of Monterey Bay.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">"Output: </span><span class="sc">{{</span><span class="st">'SPECIES NAME': ['Strongylocentrotus fransiscanus', 'S. purpuratus'], 'HABITAT': ['subtidal', 'intertidal'], 'LOC': ['Monterey Bay']</span><span class="sc">}}</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">2. Sentence: Cucumaria curata and C. pseudocurata live and feed in the hydrodynamically stressful environment of exposed intertidal areas.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="st">Output: </span><span class="sc">{{</span><span class="st">'SPECIES NAME': ['Cucumaria curata', 'C. pseudocurata'], 'HABITAT': ['exposed intertidal'], 'LOC': ['None']</span><span class="sc">}}</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">Chat History:</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="sc">{chat_history}</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">Follow Up Input: </span><span class="sc">{question}</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="34a802bf" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>CUSTOM_QUESTION_PROMPT <span class="op">=</span> PromptTemplate.from_template(custom_template)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9e3c1603" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>memory <span class="op">=</span> VectorStoreRetrieverMemory(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>memory_key<span class="op">=</span><span class="st">"chat_history"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>return_docs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>retriever<span class="op">=</span>vector_store,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>return_messages<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7692791b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Formats the chat history string</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_chat_history(inputs) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> []</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> human, ai <span class="kw">in</span> inputs:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        res.append(<span class="ss">f"Human:</span><span class="sc">{</span>human<span class="sc">}</span><span class="ch">\n</span><span class="ss">AI:</span><span class="sc">{</span>ai<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b38cb8d8" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>qa_chain <span class="op">=</span> ConversationalRetrievalChain.from_llm(ChatOpenAI(), </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                                 compression_retriever,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                                 memory <span class="op">=</span> memory,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                                                 return_source_documents <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                                 condense_question_prompt <span class="op">=</span> CUSTOM_QUESTION_PROMPT,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                                                 get_chat_history <span class="op">=</span> get_chat_history)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                                                </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ac66ea6b" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"What is this paper about?"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>query1a <span class="op">=</span> <span class="st">"What were the significant findings on the relationship mentioned?"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>query2 <span class="op">=</span> <span class="st">"Summarize the paper concisely with reference to materials and methods."</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>query3 <span class="op">=</span> <span class="st">"Write a one sentence summary of the purpose of the paper"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>query4 <span class="op">=</span> <span class="st">"Terms that may be used to identify an observation include “in the field”, “this study”, “observed”, “taken”, “collected”, “sampled”, “collection”, “seen”, “harvested”, “found”, etc. Does the paper include one or more observations?"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>query5 <span class="op">=</span> <span class="st">"Does this paper contain observational or experimental research conducted in the natural environment or with organisms collected in nature?"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>query6 <span class="op">=</span> <span class="st">"What are the scientific names of the collected species mentioned in this paper?"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>query6a <span class="op">=</span> <span class="st">"Where were the species collected?"</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>query7 <span class="op">=</span> <span class="st">"Does the paper mention where the species were observed or collected, and if so, what locations are given?"</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>query7a <span class="op">=</span> <span class="st">"Please list the species collected based on their scientific names along with location of collection."</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>query8 <span class="op">=</span> <span class="st">"Can you give a more specific location?"</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>query9 <span class="op">=</span> <span class="st">"Are any coordinate locations given in latitude / longitude, and if so, what are they?"</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>query10 <span class="op">=</span> <span class="st">"In what habitat were the species found?"</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>query10a <span class="op">=</span> <span class="st">"Can you give a more specific location of the habitat such as formal name of said location?"</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>query11 <span class="op">=</span> <span class="st">"Does the paper mention a year, date and/or time that species were collected or observed, and if so, what was mentioned?"</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>query12 <span class="op">=</span> <span class="st">"Are there any maps, figures, tables or diagrams in the paper?"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fc78f6b5" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>chat_history <span class="op">=</span> []</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4df191f6" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>result1<span class="op">=</span> qa_chain({<span class="st">"question"</span>: query, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\aclao89\AppData\Local\anaconda3\lib\site-packages\langchain\chains\llm.py:275: UserWarning: The predict_and_parse method is deprecated, instead pass an output parser directly to LLMChain.
  warnings.warn(</code></pre>
</div>
</div>
<div id="1d17447a" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>result1[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>'The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.'</code></pre>
</div>
</div>
<div id="f9f66256" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>result1[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>[Document(page_content='Mean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus', metadata={}),
 Document(page_content='A multitude of species coexist in the marine intertidal environment. Closely related \nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \nconsiderable habitat overlap between these two species; the underside of a single rock may have \nCharifson 3 \n \nroughly equal abundances of the two crab species (personal observation). The size of the chela \nmay differ, which could allow the crabs to differentiate in food resource utilization.', metadata={}),
 Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1). In general the ability of carapace width to explain the variance in chela size parameters (i.', metadata={})]</code></pre>
</div>
</div>
<div id="8d5c2419" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>result1[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>[Document(page_content='8 \n0.9 \n1 \nFe1 \nFe2 \nFe3 \nMa1 \nMa2 \nMa3 \nMean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus \n', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A \nsignificant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.  \n \nCrab Feeding Preference:  \n \nExpected values for both the number of L. scutulata and L. vincta consumed for the G-\ntest are 0.5 multiplied by the total number of snails consumed by each individual crab. G-tests \nfor individual H. nudus that eat snails were all significant at p &lt; 0.001 with 1 degree of freedom \n(See Table 2 for statistical summary). The three crabs that did not eat either L. scutulata or L. \nvincta could not be tested for feeding preference.  \nCharifson 7 \n \n \nSnail Consumption by Hemigrapsus nudus \n \nNo significant difference in crab feeding rate (snails consumed/hour) was found (F2, 21 = \n2.52, p = 0.104) among individual H. nudus that fed on snails during the course of the \nconsumption experiment (Figure 5). Fe2  ate snails at a rate of 0.59±0.53 snails/hour (variance is \nstandard deviation), Ma1 feeding rate was 0.24±0.31 snails/hour, and Ma2 had a feeding rate of \n0.80±0.38 snails/hour. Individuals Fe1, Fe3 and Ma3 did not consume any snails during the \ncourse of the experiment.  \n \nDiscussion: \n \nA few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus \nand Hemigrapsus orogenensis. The variance in propal height or propal width explained by \ncarapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for \npropal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela \nsize parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width \nrespectively. The R2 values for propal width regressed against carapace width were consistently \nlower than propal height regressed against carapace width across species and sexes (Table 1). In \ngeneral the ability of carapace width to explain the variance in chela size parameters (i.', metadata={}),
 Document(page_content='Charifson 1 \n \nSnail Predation by Hemigrapsus nudus and Hemigrapsus oregonensis: Sex and Species \nDifferences in Chela Size. \n \nDavid Charifson1,2 \n \nMarine Invertebrate Zoology \nSummer 2014 \n \n \n \n \n1 Friday Harbor Laboratories, University of Washington, Friday Harbor, WA 98250 \n2 Department of Ecology and Evolution, Stony Brook University, Stony Brook, NY 11794-5245 \n \n \n \n \nContact information: \nDavid Charifson \nDepartment of Ecology and Evolution \nStony Brook University \n650 Life Sciences Building \nStony Brook, NY 11794-5245 \nDavid.charifson@stonybrook.edu  \n \n \n \n \nKeywords: Hemigrapsus nudus, Hemigrapsus orogenensis, Littorina scutulata, Lacuna vincta, \npredation, sexual dimorphism, character displacement  \n \n \nCharifson 2 \n \nAbstract: \n \nThe relationship between propus size and use of snails as prey in sympatric populations \nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \nwidth increases with body size in a predictable manner in male and female crabs of both species. \nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \nno character displacement in this trait. Both species of crabs showed a strong feeding preference \nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \ndue to the ease of consumption. There were no differences in snail consumption rates between \nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \nindividual crabs.  \n \nIntroduction: \n \nA multitude of species coexist in the marine intertidal environment. Closely related \nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \nconsiderable habitat overlap between these two species; the underside of a single rock may have \nCharifson 3 \n \nroughly equal abundances of the two crab species (personal observation). The size of the chela \nmay differ, which could allow the crabs to differentiate in food resource utilization. \nBoth species are omnivores that eat algae and small invertebrates, including snails \n(Behrens Yamada and', metadata={})]</code></pre>
</div>
</div>
<div id="95ca967d" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>result1a <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query1a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a3900566" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>result1a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>'The significant findings on the relationship between carapace width and propal height and width in Hemigrapsus are as follows:\n\n1. Carapace width was a good predictor of both propal height and propal width in female and male H. oregonensis and H. nudus.\n\n2. There was less variation in the relationship between carapace width and propal height than with propal width.\n\n3. A significant effect for sex was found for both carapace width:propal height (CW:PH) and carapace width:propal width (CW:PW). \n\n4. There was no significant difference between Hemigrapsus species for CW:PH and CW:PW.\n\n5. A significant sex*species interaction was detected for both CW:PH and CW:PW.'</code></pre>
</div>
</div>
<div id="878c2586" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>result1a[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[Document(page_content='Figure 1: Relationship of carapace width and propal height in Hemigrapsus. Line of best fit from \nSMA regression. See Table 1A for descriptive statistics. A) Female H. nudus. B) Male H. nudus. \nC) Female H. oregonensis. D) Male H. oregonensis.  \n\nFigure 2: Relationship of carapace width and propal width in Hemigrapsus.  \nLine of best fit from SMA regression. See Table 1B for descriptive statistics. A) Female H. \nnudus. B) Male H. nudus. C)Female H. oregonensis. D) Male H. oregonensis.  \n\nFigure 3: Differences in propal height:carapace width ratio between sex and species. \nThe sex factor was statistically significant (F = 125.6. p &lt; 0.001), while the species factor was \ninsignificant (F &gt; 0.01, p = 0.983). There was a significant interaction (F = 4.39, p = 0.042). \nError bars represent standard error of the mean.  \n\nFigure 4: Differences in propal width:carapace width ratio between sex and species. \nThe sex factor was statistically significant (F1,45 = 103.8. p &lt; 0.001), while the species factor was \ninsignificant (F1,45  = 0.09, p = 0.764). There was a significant interaction (F1,45  = 7.19, p = \n0.01). Error bars represent standard error of the mean.', metadata={}),
 Document(page_content='Table 1: SMA regressions of carapace width and propus measures.  \nA) The relationship between carapace width and propal height. x is carapace width and y is \npropal height. B) The relationship between carapace width and propal height. x is carapace width \nand y is propal width.  \n\nSMA Regression  \n\nA \n\nN \nCarapace Width vs Propal Height  \nR2 \n\nFemale H. nudus \n13 \ny = 0.273*x - 0.678 \n0.976 \n\nMale H. nudus \n13 \ny = 0.311*x - 1.385 \n0.868 \n\nFemale H. oregonensis \n9 \ny = 0.351*x - 0.833 \n0.894 \n\nMale H. oregonensis \n14 \ny = 0.39*x - 1.149 \n0.693 \n\nSMA Regression  \n\nB \n\nN \nCarapace Width vs Propal Width  \nR2 \n\nFemale H. nudus \n13 \ny = 0.157*x - 0.386 \n0.927 \n\nMale H. nudus \n13 \ny = 0.209*x - 1.288 \n0.859 \n\nFemale H. oregonensis \n9 \ny = 0.175*x + 0.037 \n0.724 \n\nMale H. oregonensis \n14 \ny = 0.244*x - 0.688 \n0.534 \n\nTable 2: Size and prey preference in H. nudus.  \nSize parameters of experimental Hemigrapsus nudus and number of prey consumed in 24 hour \nintervals (three trials). Crabs Fe1, Fe3, and Ma3 did not feed on snails and were not testable (NT) \nfor preference. \nIndividual \nCarapace \nWidth (mm) \nPropal \nHeight (mm) \nNumber of \nLacuna vincta \nconsumed \nNumber of \nLittorina scutulata \nconsumed \n\nG \n\np-value \nFe1 \n23.6 \n5.9 \n0 \n0 \nNT \n\nFe2 \n23.1 \n5.5 \n15 \n0 \n20.8 \np &lt; 0.001 \nFe3 \n20.6 \n5 \n0 \n0 \nNT \n\nMa1 \n19.1 \n5.4 \n14 \n0 \n19.4 \np &lt; 0.001 \nMa2 \n18.4 \n5.4 \n15 \n0 \n20.8 \np &lt; 0.001 \nMa3 \n20.1 \n6 \n0 \n0 \nNT \n\nFigure 1: Relationship of carapace width and propal height in Hemigrapsus. Line', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth. A significant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.', metadata={})]</code></pre>
</div>
</div>
<div id="3eb2d253" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>result1a[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[Document(page_content=' \n0 \n0 \nNT \n \n \n \n \nCharifson 15 \n \n \nFigure 1: Relationship of carapace width and propal height in Hemigrapsus. Line of best fit from \nSMA regression. See Table 1A for descriptive statistics. A) Female H. nudus. B) Male H. nudus. \nC) Female H. oregonensis. D) Male H. oregonensis.  \n \n \n \nCharifson 16 \n \n \nFigure 2: Relationship of carapace width and propal width in Hemigrapsus.  \nLine of best fit from SMA regression. See Table 1B for descriptive statistics. A) Female H. \nnudus. B) Male H. nudus. C)Female H. oregonensis. D) Male H. oregonensis.  \n \n \n \nCharifson 17 \n \n \nFigure 3: Differences in propal height:carapace width ratio between sex and species. \nThe sex factor was statistically significant (F = 125.6. p &lt; 0.001), while the species factor was \ninsignificant (F &gt; 0.01, p = 0.983). There was a significant interaction (F = 4.39, p = 0.042). \nError bars represent standard error of the mean.  \n \n \n \n0 \n0.05 \n0.1 \n0.15 \n0.2 \n0.25 \n0.3 \n0.35 \nH. nudus \nH. oregonensis \nPropal Height:Carapace Width \nCrab Species \nFemale \nMale \nCharifson 18 \n \n \nFigure 4: Differences in propal width:carapace width ratio between sex and species. \nThe sex factor was statistically significant (F1,45 = 103.8. p &lt; 0.001), while the species factor was \ninsignificant (F1,45  = 0.09, p = 0.764). There was a significant interaction (F1,45  = 7.19, p = \n0.01). Error bars represent standard error of the mean.  \n \n \n \n0 \n0.05 \n0.1 \n0.15 \n0.2 \n0.25 \nH. nudus \nH. oregonensis \nPropal Widtht:Carapace Width \nCrab Species \nFemale \nMale \nCharifson 19 \n \n \nFigure 5: Consumption rates by individual H. nudus.  \nMean consumption rates (n = 8 trials) of 3 female (Fe1 to Fe3) and 3 male (Ma1 to Ma3) H. \nnudus. Crabs Fe1, Fe3, and Ma3 did not consume snails. The individuals that eat snails did not \ndiffer in their consumption rates (F2,21  = 2.52, p = 0.104). Error bars represent standard error of \nthe mean.  \n  \n0 \n0.1 \n0.2 \n0.3 \n0.4 \n0.5 \n0.6 \n0.7 \n0.8 \n0.9 \n1 \nFe1 \nFe2 \nFe3 \nMa1 \nMa2 \nMa3 \nMean Consumption Rate  \n(Snails Consumed/Hour)', metadata={}),
 Document(page_content=' \n \n \n \n \n \nCharifson 13 \n \nTable 1: SMA regressions of carapace width and propus measures.  \nA) The relationship between carapace width and propal height. x is carapace width and y is \npropal height. B) The relationship between carapace width and propal height. x is carapace width \nand y is propal width.  \n \n \n \nSMA Regression  \n \nA \n \nN \nCarapace Width vs Propal Height  \nR2 \n \nFemale H. nudus \n13 \ny = 0.273*x - 0.678 \n0.976 \n \nMale H. nudus \n13 \ny = 0.311*x - 1.385 \n0.868 \n \nFemale H. oregonensis \n9 \ny = 0.351*x - 0.833 \n0.894 \n \nMale H. oregonensis \n14 \ny = 0.39*x - 1.149 \n0.693 \n \n \n \n \n \n \n \n \nSMA Regression  \n \nB \n \nN \nCarapace Width vs Propal Width  \nR2 \n \nFemale H. nudus \n13 \ny = 0.157*x - 0.386 \n0.927 \n \nMale H. nudus \n13 \ny = 0.209*x - 1.288 \n0.859 \n \nFemale H. oregonensis \n9 \ny = 0.175*x + 0.037 \n0.724 \n \nMale H. oregonensis \n14 \ny = 0.244*x - 0.688 \n0.534 \n \n \nCharifson 14 \n \nTable 2: Size and prey preference in H. nudus.  \nSize parameters of experimental Hemigrapsus nudus and number of prey consumed in 24 hour \nintervals (three trials). Crabs Fe1, Fe3, and Ma3 did not feed on snails and were not testable (NT) \nfor preference. \nIndividual \nCarapace \nWidth (mm) \nPropal \nHeight (mm) \nNumber of \nLacuna vincta \nconsumed \nNumber of \nLittorina scutulata \nconsumed \n \nG \n \np-value \nFe1 \n23.6 \n5.9 \n0 \n0 \nNT \n \nFe2 \n23.1 \n5.5 \n15 \n0 \n20.8 \np &lt; 0.001 \nFe3 \n20.6 \n5 \n0 \n0 \nNT \n \nMa1 \n19.1 \n5.4 \n14 \n0 \n19.4 \np &lt; 0.001 \nMa2 \n18.4 \n5.4 \n15 \n0 \n20.8 \np &lt; 0.001 \nMa3 \n20.1 \n6 \n0 \n0 \nNT \n \n \n \n \nCharifson 15 \n \n \nFigure 1: Relationship of carapace width and propal height in Hemigrapsus. Line', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A \nsignificant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.  \n \nCrab Feeding Preference:  \n \nExpected values for both the number of L. scutulata and L. vincta consumed for the G-\ntest are 0.5 multiplied by the total number of snails consumed by each individual crab. G-tests \nfor individual H. nudus that eat snails were all significant at p &lt; 0.001 with 1 degree of freedom \n(See Table 2 for statistical summary). The three crabs that did not eat either L. scutulata or L. \nvincta could not be tested for feeding preference.  \nCharifson 7 \n \n \nSnail Consumption by Hemigrapsus nudus \n \nNo significant difference in crab feeding rate (snails consumed/hour) was found (F2, 21 = \n2.52, p = 0.104) among individual H. nudus that fed on snails during the course of the \nconsumption experiment (Figure 5). Fe2  ate snails at a rate of 0.59±0.53 snails/hour (variance is \nstandard deviation), Ma1 feeding rate was 0.24±0.31 snails/hour, and Ma2 had a feeding rate of \n0.80±0.38 snails/hour. Individuals Fe1, Fe3 and Ma3 did not consume any snails during the \ncourse of the experiment.  \n \nDiscussion: \n \nA few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus \nand Hemigrapsus orogenensis. The variance in propal height or propal width explained by \ncarapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for \npropal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela \nsize parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width \nrespectively. The R2 values for propal width regressed against carapace width were consistently \nlower than propal height regressed against carapace width across species and sexes (Table 1). In \ngeneral the ability of carapace width to explain the variance in chela size parameters (i.', metadata={})]</code></pre>
</div>
</div>
<div id="78a9a1bf" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>result2 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query2, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c5826ab7" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>result2[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>'The paper focuses on the study of snail predation by Hemigrapsus nudus and Hemigrapsus oregonensis, specifically examining sex and species differences in chela size. The materials and methods involved the measurement of carapace width and propal width in both female and male H. nudus. A line of best fit was determined using SMA regression. The propal height:carapace width ratio and propal width:carapace width ratio were analyzed to determine differences between sexes and species. The preference experiment involved providing crabs with five snails in each trial and measuring the number of snails consumed after 1.5 to 3 hours, which was then converted to a consumption rate. A total of eight feeding trials were conducted.'</code></pre>
</div>
</div>
<div id="e6b56970" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>result2[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>[Document(page_content='The main topic of this paper is the study of snail predation by Hemigrapsus nudus and Hemigrapsus oregonensis, specifically examining sex and species differences in chela size.', metadata={}),
 Document(page_content='Figure 2: The relationship between carapace width and propal width in Hemigrapsus:\n   - For both female and male H. nudus, a line of best fit was determined using SMA regression.\n   - Descriptive statistics for this relationship can be found in Table 1B.\n\nFigure 3: Differences in propal height:carapace width ratio between sex and species:\n   - The sex factor was statistically significant (F = 125.6, p &lt; 0.001), indicating that there is a significant difference in propal height:carapace width ratio between males and females.\n   - The species factor was insignificant (F &gt; 0.01, p = 0.983), suggesting that there is no significant difference in propal height:carapace width ratio between H. oregonensis and H. nudus.\n   - There was a significant interaction (F = 4.39, p = 0.042), indicating that the effect of sex on propal height:carapace width ratio may vary depending on the species.\n\nFigure 4: Differences in propal width:carapace width ratio between sex and species:\n   - The sex factor was statistically significant (F1,45 = 103.8, p &lt; 0.001), indicating that there is a significant difference in propal width:carapace width ratio between males and females.\n   - The species factor was insignificant (F1,45 = 0.09, p = 0.764), suggesting that there is no significant difference in propal width:carapace width ratio between H. oregonensis and H. nudus.\n   - There was a significant interaction (F1,45 = 7.19, p = 0.01), indicating that the effect of sex on propal width:carapace width ratio may vary depending on the species.', metadata={}),
 Document(page_content='The crabs from the preference experiment were given five of each snail in each trial. \nAfter 1.5 to 3 hours the number of snails consumed was counted and converted to a consumption \nrate (snails consumed/hour). A total of eight feeding trials were conducted.', metadata={})]</code></pre>
</div>
</div>
<div id="9bb7411d" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>result2[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>[Document(page_content='question: What is this paper about?\nanswer: The main topic of this paper is the study of snail predation by Hemigrapsus nudus and Hemigrapsus oregonensis, specifically examining sex and species differences in chela size.\nsource_documents: [Document(page_content=\'The main topic or subject of this paper is the "Snail Predation by Hemigrapsus nudus and Hemigrapsus oregonensis: Sex and Species Differences in Chela Size."\', metadata={})]', metadata={}),
 Document(page_content="question: What were the significant findings on the relationship mentioned?\nanswer: From the given information, we can determine the following significant findings:\n\n1. Figure 2: The relationship between carapace width and propal width in Hemigrapsus:\n   - For both female and male H. nudus, a line of best fit was determined using SMA regression.\n   - Descriptive statistics for this relationship can be found in Table 1B.\n\n2. Figure 3: Differences in propal height:carapace width ratio between sex and species:\n   - The sex factor was statistically significant (F = 125.6, p &lt; 0.001), indicating that there is a significant difference in propal height:carapace width ratio between males and females.\n   - The species factor was insignificant (F &gt; 0.01, p = 0.983), suggesting that there is no significant difference in propal height:carapace width ratio between H. oregonensis and H. nudus.\n   - There was a significant interaction (F = 4.39, p = 0.042), indicating that the effect of sex on propal height:carapace width ratio may vary depending on the species.\n\n3. Figure 4: Differences in propal width:carapace width ratio between sex and species:\n   - The sex factor was statistically significant (F1,45 = 103.8, p &lt; 0.001), indicating that there is a significant difference in propal width:carapace width ratio between males and females.\n   - The species factor was insignificant (F1,45 = 0.09, p = 0.764), suggesting that there is no significant difference in propal width:carapace width ratio between H. oregonensis and H. nudus.\n   - There was a significant interaction (F1,45 = 7.19, p = 0.01), indicating that the effect of sex on propal width:carapace width ratio may vary depending on the species.\nsource_documents: [Document(page_content='Figure 2: Relationship of carapace width and propal width in Hemigrapsus.  \\nLine of best fit from SMA regression. See Table 1B for descriptive statistics. A) Female H. \\nnudus. B) Male H. nudus. C)Female H. oregonensis. D) Male H. oregonensis.  \\n\\nFigure 3: Differences in propal height:carapace width ratio between sex and species. \\nThe sex factor was statistically significant (F = 125.6. p &lt; 0.001), while the species factor was \\ninsignificant (F &gt; 0.01, p = 0.983). There was a significant interaction (F = 4.39, p = 0.042). \\nError bars represent standard error of the mean.  \\n\\nFigure 4: Differences in propal width:carapace width ratio between sex and species. \\nThe sex factor was statistically significant (F1,45 = 103.8. p &lt; 0.001), while the species factor was \\ninsignificant (F1,45  = 0.09, p = 0.764). There was a significant interaction (F1,45  = 7.19, p = \\n0.01). Error bars represent standard error of the mean.', metadata={}), Document(page_content='Table 2: Size and prey preference in H. nudus.  \\nSize parameters of experimental Hemigrapsus nudus and number of prey consumed in 24 hour \\nintervals (three trials). Crabs Fe1, Fe3, and Ma3 did not feed on snails and were not testable (NT) \\nfor preference. \\nIndividual \\nCarapace \\nWidth (mm) \\nPropal \\nHeight (mm) \\nNumber of \\nLacuna vincta \\nconsumed \\nNumber of \\nLittorina scutulata \\nconsumed \\n \\nG \\n \\np-value \\nFe1 \\n23.6 \\n5.9 \\n0 \\n0 \\nNT \\n \\nFe2 \\n23.1 \\n5.5 \\n15 \\n0 \\n20.8 \\np &lt; 0.001 \\nFe3 \\n20.6 \\n5 \\n0 \\n0 \\nNT \\n \\nMa1 \\n19.1 \\n5.4 \\n14 \\n0 \\n19.4 \\np &lt; 0.001 \\nMa2 \\n18.4 \\n5.4 \\n15 \\n0 \\n20.8 \\np &lt; 0.001 \\nMa3 \\n20.1 \\n6 \\n0 \\n0 \\nNT', metadata={})]", metadata={}),
 Document(page_content='\nMa3 \nMean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus \n', metadata={})]</code></pre>
</div>
</div>
<div id="faebf4ac" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>result3 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query3, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="eeb7dd56" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>result3[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>'The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.'</code></pre>
</div>
</div>
<div id="82b0b439" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>result3[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>[Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth. A significant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.', metadata={})]</code></pre>
</div>
</div>
<div id="3182b300" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>result3[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>[Document(page_content="question: What is this paper about?\nanswer: The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.\nsource_documents: [Document(page_content='Mean Consumption Rate  \\n(Snails Consumed/Hour) \\nIndividual H. nudus', metadata={}), Document(page_content='A multitude of species coexist in the marine intertidal environment. Closely related \\nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \\nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \\nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \\nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \\nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \\nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \\nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \\nconsiderable habitat overlap between these two species; the underside of a single rock may have \\nCharifson 3 \\n \\nroughly equal abundances of the two crab species (personal observation). The size of the chela \\nmay differ, which could allow the crabs to differentiate in food resource utilization.', metadata={}), Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1). In general the ability of carapace width to explain the variance in chela size parameters (i.', metadata={})]", metadata={}),
 Document(page_content='8 \n0.9 \n1 \nFe1 \nFe2 \nFe3 \nMa1 \nMa2 \nMa3 \nMean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus \n', metadata={}),
 Document(page_content='Charifson 1 \n \nSnail Predation by Hemigrapsus nudus and Hemigrapsus oregonensis: Sex and Species \nDifferences in Chela Size. \n \nDavid Charifson1,2 \n \nMarine Invertebrate Zoology \nSummer 2014 \n \n \n \n \n1 Friday Harbor Laboratories, University of Washington, Friday Harbor, WA 98250 \n2 Department of Ecology and Evolution, Stony Brook University, Stony Brook, NY 11794-5245 \n \n \n \n \nContact information: \nDavid Charifson \nDepartment of Ecology and Evolution \nStony Brook University \n650 Life Sciences Building \nStony Brook, NY 11794-5245 \nDavid.charifson@stonybrook.edu  \n \n \n \n \nKeywords: Hemigrapsus nudus, Hemigrapsus orogenensis, Littorina scutulata, Lacuna vincta, \npredation, sexual dimorphism, character displacement  \n \n \nCharifson 2 \n \nAbstract: \n \nThe relationship between propus size and use of snails as prey in sympatric populations \nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \nwidth increases with body size in a predictable manner in male and female crabs of both species. \nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \nno character displacement in this trait. Both species of crabs showed a strong feeding preference \nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \ndue to the ease of consumption. There were no differences in snail consumption rates between \nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \nindividual crabs.  \n \nIntroduction: \n \nA multitude of species coexist in the marine intertidal environment. Closely related \nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \nconsiderable habitat overlap between these two species; the underside of a single rock may have \nCharifson 3 \n \nroughly equal abundances of the two crab species (personal observation). The size of the chela \nmay differ, which could allow the crabs to differentiate in food resource utilization. \nBoth species are omnivores that eat algae and small invertebrates, including snails \n(Behrens Yamada and', metadata={})]</code></pre>
</div>
</div>
<div id="8b94c3e9" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>query3a <span class="op">=</span> <span class="st">"Since the crabs were feeding on snails, what were the scientific names of the snails?"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>result3a <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query3a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9abf9520" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result3a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>'The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.'</code></pre>
</div>
</div>
<div id="deced7f9" class="cell" data-scrolled="true" data-execution_count="31">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>result3a[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>[Document(page_content='Littorina scutulata (Gould 1849) and Littorina sitkana (Philippi 1846)', metadata={}),
 Document(page_content='Hemigrapsus nudus, Hemigrapsus oregonensis, Littorina scutulata, Lacuna vincta', metadata={}),
 Document(page_content='Hemigrapsus nudus and Hemigrapsus oregonensis', metadata={})]</code></pre>
</div>
</div>
<div id="66dfd57f" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>result3a[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>[Document(page_content=' of the chela \nmay differ, which could allow the crabs to differentiate in food resource utilization. \nBoth species are omnivores that eat algae and small invertebrates, including snails \n(Behrens Yamada and Boulding 1996). The two shore crab species are known to eat Littorina \nsitkana (Philippi 1846) and Littorina scutulata (Gould 1849), which also occur in the rocky \nintertidal zone (Behrens Yamada and Boulding 1996). Li. scutulata moves upshore in response \nto the presence of H. nudus and crushed conspecifics, where H. nudus density is lower (Keppel \nand Scrosati 2004). This suggests that H. nudus represents an ecologically significant predation \nthreat to littorines.  \n \nThe thick shelled littorines are difficult prey for both H. nudus and H. oregonensis as \nneither crab species is a molluscivore specialists; they typically scrape or pick algae and softer \ninvertebrates off rocks using their chelae (Behrens Yamada and Boulding 1996). Behrens \nYamada and Boulding (1998) found that large H. nudus were capable of consuming Li. sitkana \nthat were less than 8 mm in length, but had only a 37% success rate of consuming snails with \nlengths between 5.5-7 mm .  \nI sought to investigate differences in propus size between between males and females of \nthese two crab species. The size of the propus of the chela is positively correlated with the \namount of force that can be produced due to greater musculature (Behrens Yamada and Boulding \n1998). A significant difference in propus size between the two species would suggest that further \ntesting of character displacement may be warranted. A disparity in propus size to body size \nbetween male and female crabs might result in different feeding rates and shell breaking \ncapabilities. I devised a test of preference by varying snail shell strength within the same size \nclass. The snail species Li. scutulata and Lacuna vincta (Montagu 1803) are both in the family \nCharifson 4 \n \nLittorinidae and have similar shell shape but different shell thickness. Lacuna vincta has a \nthinner, more fragile shell and is likely to be preferred as prey by shore crabs. I also hypothesize \nthat, if chela size is held constant, female crabs will have greater snail consumption rates than \nmale crabs. Female crabs with claws equivalent to males have a larger body mass,are likely to \nhave greater metabolic need, and are less easily satiated. \n \nStudy System: \n \nAll specimens were collected on San Juan Island, Washington.  Two shore crabs (clade: \nBrachyura: Family Grapsidae), Hemigrapsus oregonensis  and Hemigrapsus nudus were \ncollected in the intertidal adjacent to the Friday Harbor Laboratories dock. These closely related \ncrabs are morphologically similar, but can be distinguished by the presence of purple spots on \nthe cheliped of H. nudus and abundant setae on the pereopods of H. oregonensis (Kozloff 1987). \nLacuna vincta, in the Class Gastropoda and Family Littoridae, were collected at False Bay and \nDead Man Cove. Littorina scutulata, in the Class Gastropoda and Family Littor', metadata={}),
 Document(page_content='Charifson 1 \n \nSnail Predation by Hemigrapsus nudus and Hemigrapsus oregonensis: Sex and Species \nDifferences in Chela Size. \n \nDavid Charifson1,2 \n \nMarine Invertebrate Zoology \nSummer 2014 \n \n \n \n \n1 Friday Harbor Laboratories, University of Washington, Friday Harbor, WA 98250 \n2 Department of Ecology and Evolution, Stony Brook University, Stony Brook, NY 11794-5245 \n \n \n \n \nContact information: \nDavid Charifson \nDepartment of Ecology and Evolution \nStony Brook University \n650 Life Sciences Building \nStony Brook, NY 11794-5245 \nDavid.charifson@stonybrook.edu  \n \n \n \n \nKeywords: Hemigrapsus nudus, Hemigrapsus orogenensis, Littorina scutulata, Lacuna vincta, \npredation, sexual dimorphism, character displacement  \n \n \nCharifson 2 \n \nAbstract: \n \nThe relationship between propus size and use of snails as prey in sympatric populations \nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \nwidth increases with body size in a predictable manner in male and female crabs of both species. \nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \nno character displacement in this trait. Both species of crabs showed a strong feeding preference \nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \ndue to the ease of consumption. There were no differences in snail consumption rates between \nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \nindividual crabs.  \n \nIntroduction: \n \nA multitude of species coexist in the marine intertidal environment. Closely related \nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \nconsiderable habitat overlap between these two species; the underside of a single rock may have \nCharifson 3 \n \nroughly equal abundances of the two crab species (personal observation). The size of the chela \nmay differ, which could allow the crabs to differentiate in food resource utilization. \nBoth species are omnivores that eat algae and small invertebrates, including snails \n(Behrens Yamada and', metadata={}),
 Document(page_content='una vincta, in the Class Gastropoda and Family Littoridae, were collected at False Bay and \nDead Man Cove. Littorina scutulata, in the Class Gastropoda and Family Littoridae, were \ncollected from the rocky intertidal zone of Fourth of July Beach.  \n \nMaterials and Methods: \nMorphometrics \n \nMale and females of H. oregonensis and H. nudus were measured with digital calipers \n(0.1 mm). Each crab was measured for carapace width, propal height and propal width. Carapace \nwidth was taken at the widest part of the carapace. Propal height was measured at the highest \nvertical distance along the propus. Propal width was measured perpendicular to propal height, \nfrom the left to right sides of the propus. All claw measurements were made on the left cheliped. \nCharifson 5 \n \nIf there was a size disparity between the left and right claws due to regeneration of a lost claw, \nthe crab was excluded from the study. Ratios of carapace width:propal height (CW:PH) and \ncarapace width:propal width (CW:PW) were calculated.  \n \nCrab Feeding Preference \n \nThree female (Fe1, Fe2, Fe3) and three male (Ma1, Ma2, Ma3) crabs of H. nudus with \npropal heights between 5-6 mm were placed in small flow-through containers. Five L. scutulata \nand five L. vincta with shell lengths between 4-6 mm were added to each container. The ranges \nof crab propal height and snail shell length were chosen based on prior studies to ensure that the \ncrabs were capable of feeding on the hard-shelled L. scutulata (Behrens Yamada and Boulding \n1998). H. oregonensis was excluded due to the rarity of female crabs of that species within the \nrange of appropriate propal heights. After approximately 15 hours the number of L. scutulata and \nL. vincta consumed was counted. Three trials were conducted for each crab. \nSnail Consumption by Hemigrapsus nudus \n \nThe crabs from the preference experiment were given five of each snail in each trial. \nAfter 1.5 to 3 hours the number of snails consumed was counted and converted to a consumption \nrate (snails consumed/hour). A total of eight feeding trials were conducted.  \n \nStatistical Analysis \n \nFor the morphometric analysis, crabs were divided into four groups based on sex and \nspecies. Standardized major axis regression was used to determine the relationship between crab \nmorphometric parameters. Arcsin transformations were used to correct for non-normality (Sokol \nand Rohlf 2011). Differences in CW:PH and CW:PW were analyzed using a two-way ANOVA \nCharifson 6 \n \nwith factors: Sex and Species. Prey selection by H. nudus was analyzed using G-tests for each \nindividual that consumed snails. An one-way ANOVA was used to determine differences in snail \nconsumption rates by H. nudus.  \n \nResults: \nMorphometrics: \n \nCarapace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was', metadata={})]</code></pre>
</div>
</div>
<div id="d2750eb0" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>result4 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query4, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="51d45fb1" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>result4[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>'Based on the given context, there is no specific mention of observations made in the field or any other type of data collection methods used in the paper.'</code></pre>
</div>
</div>
<div id="a9ca0b52" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>result4[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>[Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}),
 Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}),
 Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={})]</code></pre>
</div>
</div>
<div id="57e7285d" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>result4[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>[Document(page_content="question: What is this paper about?\nanswer: The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.\nsource_documents: [Document(page_content='Mean Consumption Rate  \\n(Snails Consumed/Hour) \\nIndividual H. nudus', metadata={}), Document(page_content='A multitude of species coexist in the marine intertidal environment. Closely related \\nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \\nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \\nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \\nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \\nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \\nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \\nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \\nconsiderable habitat overlap between these two species; the underside of a single rock may have \\nCharifson 3 \\n \\nroughly equal abundances of the two crab species (personal observation). The size of the chela \\nmay differ, which could allow the crabs to differentiate in food resource utilization.', metadata={}), Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1). In general the ability of carapace width to explain the variance in chela size parameters (i.', metadata={})]", metadata={}),
 Document(page_content="question: Write a one sentence summary of the purpose of the paper\nanswer: The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.\nsource_documents: [Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}), Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \\npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \\nless variation in the relationship between carapace width and propal height than with propal \\nwidth. A significant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \\n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \\nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \\nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \\n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \\nrespectively.', metadata={})]", metadata={}),
 Document(page_content="question: Since the crabs were feeding on snails, what were the scientific names of the snails?\nanswer: The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.\nsource_documents: [Document(page_content='Littorina scutulata (Gould 1849) and Littorina sitkana (Philippi 1846)', metadata={}), Document(page_content='Hemigrapsus nudus, Hemigrapsus oregonensis, Littorina scutulata, Lacuna vincta', metadata={}), Document(page_content='Hemigrapsus nudus and Hemigrapsus oregonensis', metadata={})]", metadata={})]</code></pre>
</div>
</div>
<div id="f587dbd6" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>result5 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query5, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="07b1f6d9" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>result5[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>'The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.'</code></pre>
</div>
</div>
<div id="d4f91e39" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>result5[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>[Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}),
 Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}),
 Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={})]</code></pre>
</div>
</div>
<div id="11c2ba94" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>result5[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>[Document(page_content="question: Terms that may be used to identify an observation include “in the field”, “this study”, “observed”, “taken”, “collected”, “sampled”, “collection”, “seen”, “harvested”, “found”, etc. Does the paper include one or more observations?\nanswer: Based on the given context, there is no specific mention of observations made in the field or any other type of data collection methods used in the paper.\nsource_documents: [Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}), Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}), Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={})]", metadata={}),
 Document(page_content="question: What is this paper about?\nanswer: The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.\nsource_documents: [Document(page_content='Mean Consumption Rate  \\n(Snails Consumed/Hour) \\nIndividual H. nudus', metadata={}), Document(page_content='A multitude of species coexist in the marine intertidal environment. Closely related \\nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \\nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \\nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \\nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \\nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \\nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \\nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \\nconsiderable habitat overlap between these two species; the underside of a single rock may have \\nCharifson 3 \\n \\nroughly equal abundances of the two crab species (personal observation). The size of the chela \\nmay differ, which could allow the crabs to differentiate in food resource utilization.', metadata={}), Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1). In general the ability of carapace width to explain the variance in chela size parameters (i.', metadata={})]", metadata={}),
 Document(page_content="question: Write a one sentence summary of the purpose of the paper\nanswer: The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.\nsource_documents: [Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}), Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \\npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \\nless variation in the relationship between carapace width and propal height than with propal \\nwidth. A significant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \\n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \\nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \\nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \\n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \\nrespectively.', metadata={})]", metadata={})]</code></pre>
</div>
</div>
<div id="699b450e" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>result6 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query6, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ece5f425" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>result6[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>'The scientific names of the species mentioned in this paper are Hemigrapsus nudus and Hemigrapsus oregonensis.'</code></pre>
</div>
</div>
<div id="d063580a" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>result6[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>[Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={}),
 Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={}),
 Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.', metadata={})]</code></pre>
</div>
</div>
<div id="a0f2994a" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>result6[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>[Document(page_content="question: Since the crabs were feeding on snails, what were the scientific names of the snails?\nanswer: The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.\nsource_documents: [Document(page_content='Littorina scutulata (Gould 1849) and Littorina sitkana (Philippi 1846)', metadata={}), Document(page_content='Hemigrapsus nudus, Hemigrapsus oregonensis, Littorina scutulata, Lacuna vincta', metadata={}), Document(page_content='Hemigrapsus nudus and Hemigrapsus oregonensis', metadata={})]", metadata={}),
 Document(page_content="question: Terms that may be used to identify an observation include “in the field”, “this study”, “observed”, “taken”, “collected”, “sampled”, “collection”, “seen”, “harvested”, “found”, etc. Does the paper include one or more observations?\nanswer: Based on the given context, there is no specific mention of observations made in the field or any other type of data collection methods used in the paper.\nsource_documents: [Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}), Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}), Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={})]", metadata={}),
 Document(page_content="question: Does this paper contain observational or experimental research conducted in the natural environment or with organisms collected in nature?\nanswer: The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.\nsource_documents: [Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}), Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}), Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={})]", metadata={})]</code></pre>
</div>
</div>
<div id="d86efc8e" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>result6a <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query6a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8bb86367" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>result6a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>'The locations from which the collected species were obtained are not mentioned in the given context.'</code></pre>
</div>
</div>
<div id="73801a2d" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>result6a[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>[Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.', metadata={}),
 Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={})]</code></pre>
</div>
</div>
<div id="422e7b5f" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>result7 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query7, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9a52e9cf" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>result7[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>'The locations from which the collected species were obtained are not mentioned in the given context.'</code></pre>
</div>
</div>
<div id="4bff96e9" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>result7[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>[Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={}),
 Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.', metadata={})]</code></pre>
</div>
</div>
<div id="4261684d" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>result7[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>[Document(page_content="question: Where were the species collected?\nanswer: The locations from which the collected species were obtained are not mentioned in the given context.\nsource_documents: [Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.', metadata={}), Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={})]", metadata={}),
 Document(page_content="question: Terms that may be used to identify an observation include “in the field”, “this study”, “observed”, “taken”, “collected”, “sampled”, “collection”, “seen”, “harvested”, “found”, etc. Does the paper include one or more observations?\nanswer: Based on the given context, there is no specific mention of observations made in the field or any other type of data collection methods used in the paper.\nsource_documents: [Document(page_content='The main objective of this paper is to investigate the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The paper also examines the potential impact of sex and species on this relationship.', metadata={}), Document(page_content='The main topic or subject matter of this paper is the coexistence and competition between two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis, in the marine intertidal environment. The paper also explores the concept of character displacement and the morphological differences between the two species.', metadata={}), Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={})]", metadata={}),
 Document(page_content="question: What are the scientific names of the collected species mentioned in this paper?\nanswer: The scientific names of the species mentioned in this paper are Hemigrapsus nudus and Hemigrapsus oregonensis.\nsource_documents: [Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={}), Document(page_content='The scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={}), Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.', metadata={})]", metadata={})]</code></pre>
</div>
</div>
<div id="ba8a24c6" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>result7a <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query7a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="74436010" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>result7a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>'The scientific names of the collected species mentioned in this paper are Hemigrapsus nudus and Hemigrapsus oregonensis. However, the locations from which these species were obtained are not mentioned in the given context.'</code></pre>
</div>
</div>
<div id="04c185ec" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>result8 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query8, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7880eedd" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>result8[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>'No, the paper does not mention any specific location where the collected species were obtained.'</code></pre>
</div>
</div>
<div id="6850eb3f" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>result9 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query9, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a3662c93" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>result9[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>"I'm sorry, but I don't have any specific coordinate locations in latitude/longitude for the collected species mentioned in the given context."</code></pre>
</div>
</div>
<div id="77672d31" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>result10 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query10, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="047019fb" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>result10[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>'No, the paper does not provide information about the specific habitat where the species were found.'</code></pre>
</div>
</div>
<div id="9d50067c" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>result10[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>[Document(page_content='No, the paper does not mention any specific location where the collected species were obtained.', metadata={}),
 Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.\nThe scientific names of the snails that the crabs were feeding on are Littorina scutulata and Lacuna vincta.', metadata={}),
 Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={})]</code></pre>
</div>
</div>
<div id="95e93b19" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>result10a <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query10a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f837a924" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>result10a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>'No, the paper does not mention any formal name or specific geographic location for the habitat where the species were collected.'</code></pre>
</div>
</div>
<div id="fe3cb901" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>result11 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query11, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="794a5329" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>result11[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>'No, the paper does not mention any year, date, or time regarding the collection or observation of the species mentioned.'</code></pre>
</div>
</div>
<div id="9614fe4e" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>result11[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>[Document(page_content='No, the paper does not mention any specific location where the collected species were obtained.', metadata={}),
 Document(page_content='No, the paper does not mention any specific location where the collected species were obtained.', metadata={}),
 Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={})]</code></pre>
</div>
</div>
<div id="cf4808bd" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>result11[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>[Document(page_content="question: Does the paper mention where the species were observed or collected, and if so, what locations are given?\nanswer: The locations from which the collected species were obtained are not mentioned in the given context.\nsource_documents: [Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={}), Document(page_content='The research conducted in this paper is primarily focused on investigating the relationship between carapace width and propal height and width in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis.', metadata={})]", metadata={}),
 Document(page_content="question: Can you give a more specific location of the habitat such as formal name of said location?\nanswer: No, the paper does not mention any formal name or specific geographic location for the habitat where the species were collected.\nsource_documents: [Document(page_content='No, the paper does not mention any specific location where the collected species were obtained.', metadata={}), Document(page_content='No, the paper does not mention any specific location where the collected species were obtained.', metadata={}), Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={})]", metadata={}),
 Document(page_content="question: Can you give a more specific location?\nanswer: No, the paper does not mention any specific location where the collected species were obtained.\nsource_documents: [Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={}), Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={}), Document(page_content='The locations from which the collected species were obtained are not mentioned in the given context.', metadata={})]", metadata={})]</code></pre>
</div>
</div>
<div id="3f9d1c76" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>result12 <span class="op">=</span> qa_chain({<span class="st">"question"</span>: query12, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3eb1a2f6" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>result12[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>'No, the paper does not mention any visual representations such as maps, figures, tables, or diagrams.'</code></pre>
</div>
</div>
</section>
<section id="conversationalretrievalchain-with-map_reduce" class="level1">
<h1>ConversationalRetrievalChain with map_reduce</h1>
<div id="b32e95f8" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>llm <span class="op">=</span> ChatOpenAI(temperature<span class="op">=</span><span class="dv">0</span>, model_name<span class="op">=</span><span class="st">'gpt-3.5-turbo'</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>compressor <span class="op">=</span> LLMChainExtractor.from_llm(llm)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>compression_retriever2 <span class="op">=</span> ContextualCompressionRetriever(base_compressor <span class="op">=</span> compressor,base_retriever<span class="op">=</span>vector_store)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b445018e" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>memory <span class="op">=</span> VectorStoreRetrieverMemory(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>memory_key<span class="op">=</span><span class="st">"chat_history"</span>,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>return_docs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>retriever<span class="op">=</span>vector_store,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>return_messages<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4ee31c45" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>qa_chain_reduce <span class="op">=</span> ConversationalRetrievalChain.from_llm(ChatOpenAI(),</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>                                                 compression_retriever2,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                                                 memory <span class="op">=</span> memory,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                                                 return_source_documents <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                                                 condense_question_prompt <span class="op">=</span> CUSTOM_QUESTION_PROMPT,</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>                                                 get_chat_history <span class="op">=</span> get_chat_history,</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>                                                 chain_type <span class="op">=</span> <span class="st">"map_reduce"</span>)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>                                                </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="160eebda" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>chat_history <span class="op">=</span> []</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="db7c86c8" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>result_reduce <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\aclao89\AppData\Local\anaconda3\lib\site-packages\langchain\chains\llm.py:275: UserWarning: The predict_and_parse method is deprecated, instead pass an output parser directly to LLMChain.
  warnings.warn(</code></pre>
</div>
</div>
<div id="eeabc90c" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>result_reduce[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>'The subject matter of this paper appears to be the morphometric analysis of two species of crabs, Hemigrapsus nudus and Hemigrapsus orogenensis.'</code></pre>
</div>
</div>
<div id="9058264e" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>result_reduce[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[Document(page_content='The relationship between propus size and use of snails as prey in sympatric populations \nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \nwidth increases with body size in a predictable manner in male and female crabs of both species. \nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \nno character displacement in this trait. Both species of crabs showed a strong feeding preference \nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \ndue to the ease of consumption. There were no differences in snail consumption rates between \nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \nindividual crabs.', metadata={}),
 Document(page_content='Mean Consumption Rate  \n(Snails Consumed/Hour)', metadata={}),
 Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1).', metadata={})]</code></pre>
</div>
</div>
<div id="995ec463" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>result_reduce[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>[Document(page_content='8 \n0.9 \n1 \nFe1 \nFe2 \nFe3 \nMa1 \nMa2 \nMa3 \nMean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus \n', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A \nsignificant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.  \n \nCrab Feeding Preference:  \n \nExpected values for both the number of L. scutulata and L. vincta consumed for the G-\ntest are 0.5 multiplied by the total number of snails consumed by each individual crab. G-tests \nfor individual H. nudus that eat snails were all significant at p &lt; 0.001 with 1 degree of freedom \n(See Table 2 for statistical summary). The three crabs that did not eat either L. scutulata or L. \nvincta could not be tested for feeding preference.  \nCharifson 7 \n \n \nSnail Consumption by Hemigrapsus nudus \n \nNo significant difference in crab feeding rate (snails consumed/hour) was found (F2, 21 = \n2.52, p = 0.104) among individual H. nudus that fed on snails during the course of the \nconsumption experiment (Figure 5). Fe2  ate snails at a rate of 0.59±0.53 snails/hour (variance is \nstandard deviation), Ma1 feeding rate was 0.24±0.31 snails/hour, and Ma2 had a feeding rate of \n0.80±0.38 snails/hour. Individuals Fe1, Fe3 and Ma3 did not consume any snails during the \ncourse of the experiment.  \n \nDiscussion: \n \nA few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus \nand Hemigrapsus orogenensis. The variance in propal height or propal width explained by \ncarapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for \npropal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela \nsize parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width \nrespectively. The R2 values for propal width regressed against carapace width were consistently \nlower than propal height regressed against carapace width across species and sexes (Table 1). In \ngeneral the ability of carapace width to explain the variance in chela size parameters (i.', metadata={}),
 Document(page_content='Charifson 1 \n \nSnail Predation by Hemigrapsus nudus and Hemigrapsus oregonensis: Sex and Species \nDifferences in Chela Size. \n \nDavid Charifson1,2 \n \nMarine Invertebrate Zoology \nSummer 2014 \n \n \n \n \n1 Friday Harbor Laboratories, University of Washington, Friday Harbor, WA 98250 \n2 Department of Ecology and Evolution, Stony Brook University, Stony Brook, NY 11794-5245 \n \n \n \n \nContact information: \nDavid Charifson \nDepartment of Ecology and Evolution \nStony Brook University \n650 Life Sciences Building \nStony Brook, NY 11794-5245 \nDavid.charifson@stonybrook.edu  \n \n \n \n \nKeywords: Hemigrapsus nudus, Hemigrapsus orogenensis, Littorina scutulata, Lacuna vincta, \npredation, sexual dimorphism, character displacement  \n \n \nCharifson 2 \n \nAbstract: \n \nThe relationship between propus size and use of snails as prey in sympatric populations \nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \nwidth increases with body size in a predictable manner in male and female crabs of both species. \nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \nno character displacement in this trait. Both species of crabs showed a strong feeding preference \nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \ndue to the ease of consumption. There were no differences in snail consumption rates between \nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \nindividual crabs.  \n \nIntroduction: \n \nA multitude of species coexist in the marine intertidal environment. Closely related \nspecies may be sympatric and compete for resources, such as food. Two species of shore crab, \nHemigrapsus nudus (Dana 1851) and Hemigrapsus oregonensis (Dana 1851), occur in sympatry \nin the Salish Sea. Both species are sexually dimorphic, with the males having larger chelae. \nSpecies in sympatry may exhibit character displacement, the exaggeration of morphological or \nbehavioral characteristics due to competition for resources (Brown and Wilson 1956). When H. \nnudus and H. oregonensis co-occur, H. oregonensis tends to be found closer to the waterand in \nfiner sediment than the more desiccation-tolerant H. nudus (Sliger 1982). There is still \nconsiderable habitat overlap between these two species; the underside of a single rock may have \nCharifson 3 \n \nroughly equal abundances of the two crab species (personal observation). The size of the chela \nmay differ, which could allow the crabs to differentiate in food resource utilization. \nBoth species are omnivores that eat algae and small invertebrates, including snails \n(Behrens Yamada and', metadata={})]</code></pre>
</div>
</div>
<div id="3ad2e176" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>result_reduce1a <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query1a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d195117f" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>result_reduce1a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>'The significant findings on the relationship between carapace width and propal height and width in Hemigrapsus crabs are as follows:\n\n- The relationship between carapace width and propal height was analyzed for female H. nudus, male H. nudus, female H. oregonensis, and male H. oregonensis. The line of best fit from SMA regression was provided in Figure 1. The results showed a high variance in propal height explained by carapace width in female H. nudus, with an R2 value of 0.976.\n\n- The relationship between carapace width and propal width was also analyzed for female H. nudus, male H. nudus, female H. oregonensis, and male H. oregonensis. The line of best fit from SMA regression was provided in Figure 2. The results showed a high variance in propal width explained by carapace width in female H. nudus, with an R2 value of 0.927.\n\n- In male H. oregenensis, there was a greater variation in chela size parameters. The R2 values for propal height and propal width regressed against carapace width were 0.693 and 0.534 respectively.\n\n- The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes.\n\nIt is important to note that the text does not mention specific findings for Hemigrapsus crabs, but rather provides information on the significance of carapace width as a predictor of propal height and width in female and male H. oregonensis and H. nudus, with a significant effect for sex and a significant sex*species interaction.'</code></pre>
</div>
</div>
<div id="44aa0c3a" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>result_reduce1a[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>[Document(page_content='Figure 1: Relationship of carapace width and propal height in Hemigrapsus. Line of best fit from \nSMA regression. See Table 1A for descriptive statistics. A) Female H. nudus. B) Male H. nudus. \nC) Female H. oregonensis. D) Male H. oregonensis.  \n\nFigure 2: Relationship of carapace width and propal width in Hemigrapsus.  \nLine of best fit from SMA regression. See Table 1B for descriptive statistics. A) Female H. \nnudus. B) Male H. nudus. C)Female H. oregonensis. D) Male H. oregonensis.  \n\nFigure 3: Differences in propal height:carapace width ratio between sex and species. \nThe sex factor was statistically significant (F = 125.6. p &lt; 0.001), while the species factor was \ninsignificant (F &gt; 0.01, p = 0.983). There was a significant interaction (F = 4.39, p = 0.042). \nError bars represent standard error of the mean.  \n\nFigure 4: Differences in propal width:carapace width ratio between sex and species. \nThe sex factor was statistically significant (F1,45 = 103.8. p &lt; 0.001), while the species factor was \ninsignificant (F1,45  = 0.09, p = 0.764). There was a significant interaction (F1,45  = 7.19, p = \n0.01). Error bars represent standard error of the mean.', metadata={}),
 Document(page_content='The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1).', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth. A significant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.', metadata={})]</code></pre>
</div>
</div>
<div id="2f172ec9" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>result_reduce2 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query2, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4c212daa" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>result_reduce2[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>'The concise summary of the paper and the materials and methods used cannot be determined based on the given portion of the document.'</code></pre>
</div>
</div>
<div id="aad74378" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>result_reduce2[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>[Document(page_content='The subject matter of this paper appears to be the morphometric analysis of two species of crabs, Hemigrapsus nudus and Hemigrapsus orogenensis. The relationship between propus size and use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal width increases with body size in a predictable manner in male and female crabs of both species. Sexual dimorphism of propal height and width relationships in both shore crabs is apparent, but there was no detectible difference in chela size between H. nudus and H. oregonensis. The lack of difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is no character displacement in this trait. Both species of crabs showed a strong feeding preference for the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely due to the ease of consumption. There were no differences in snail consumption rates between male and female H. nudus of similar propal heights, mostly due to high feeding variation among individual crabs. A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes.', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A \nsignificant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.', metadata={})]</code></pre>
</div>
</div>
<div id="48831fe8" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>result_reduce3 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query3, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2748f68f" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>result_reduce3[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>'The purpose of the paper is to investigate the relationship between propus size and the use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis.'</code></pre>
</div>
</div>
<div id="f6f16e7f" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>result_reduce3[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>[Document(page_content='The subject matter of this paper appears to be the morphometric analysis of two species of crabs, Hemigrapsus nudus and Hemigrapsus orogenensis. The relationship between propus size and use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal width increases with body size in a predictable manner in male and female crabs of both species. Sexual dimorphism of propal height and width relationships in both shore crabs is apparent, but there was no detectible difference in chela size between H. nudus and H. oregonensis. The lack of difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is no character displacement in this trait. Both species of crabs showed a strong feeding preference for the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely due to the ease of consumption. There were no differences in snail consumption rates between male and female H. nudus of similar propal heights, mostly due to high feeding variation among individual crabs. A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes.', metadata={}),
 Document(page_content='The subject matter of this paper appears to be the morphometric analysis of two species of crabs, Hemigrapsus nudus and Hemigrapsus orogenensis. The relationship between propus size and use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal width increases with body size in a predictable manner in male and female crabs of both species. Sexual dimorphism of propal height and width relationships in both shore crabs is apparent, but there was no detectible difference in chela size between H. nudus and H. oregonensis. The lack of difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is no character displacement in this trait. Both species of crabs showed a strong feeding preference for the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely due to the ease of consumption. There were no differences in snail consumption rates between male and female H. nudus of similar propal heights, mostly due to high feeding variation among individual crabs. A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes.', metadata={})]</code></pre>
</div>
</div>
<div id="6c8488bd" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>result_reduce3[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>[Document(page_content="question: Summarize the paper concisely with reference to materials and methods.\nanswer: The concise summary of the paper and the materials and methods used cannot be determined based on the given portion of the document.\nsource_documents: [Document(page_content='The subject matter of this paper appears to be the morphometric analysis of two species of crabs, Hemigrapsus nudus and Hemigrapsus orogenensis. The relationship between propus size and use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal width increases with body size in a predictable manner in male and female crabs of both species. Sexual dimorphism of propal height and width relationships in both shore crabs is apparent, but there was no detectible difference in chela size between H. nudus and H. oregonensis. The lack of difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is no character displacement in this trait. Both species of crabs showed a strong feeding preference for the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely due to the ease of consumption. There were no differences in snail consumption rates between male and female H. nudus of similar propal heights, mostly due to high feeding variation among individual crabs. A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes.', metadata={}), Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \\npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \\nless variation in the relationship between carapace width and propal height than with propal \\nwidth.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A \\nsignificant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \\n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \\nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \\nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \\n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \\nrespectively.', metadata={})]", metadata={}),
 Document(page_content="question: What is this paper about?\nanswer: The subject matter of this paper appears to be the morphometric analysis of two species of crabs, Hemigrapsus nudus and Hemigrapsus orogenensis.\nsource_documents: [Document(page_content='The relationship between propus size and use of snails as prey in sympatric populations \\nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \\nwidth increases with body size in a predictable manner in male and female crabs of both species. \\nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \\nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \\nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \\nno character displacement in this trait. Both species of crabs showed a strong feeding preference \\nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \\ndue to the ease of consumption. There were no differences in snail consumption rates between \\nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \\nindividual crabs.', metadata={}), Document(page_content='Mean Consumption Rate  \\n(Snails Consumed/Hour)', metadata={}), Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1).', metadata={})]", metadata={}),
 Document(page_content='8 \n0.9 \n1 \nFe1 \nFe2 \nFe3 \nMa1 \nMa2 \nMa3 \nMean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus \n', metadata={})]</code></pre>
</div>
</div>
<div id="64331d79" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>result_reduce4 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query4, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6da5e5a9" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>result_reduce4[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>'Based on the provided portion of the document, it is not possible to determine if the paper includes any observations made in the field, in this study, or through the collection, sampling, or harvesting of specimens. The given text only describes the purpose of the paper, which is to investigate the relationship between propus size and the use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis. Therefore, it is unclear if any direct observations or specimen collection were conducted.'</code></pre>
</div>
</div>
<div id="9acd95c5" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>result_reduce5 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query5, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9bc89fd7" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>result_reduce5[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>'No, there is no mention of observational or experimental research conducted in the natural environment or with organisms collected in nature in this portion of the document.'</code></pre>
</div>
</div>
<div id="a7dae99e" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>result_reduce6 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query6, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8cd9d4f6" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>result_reduce6[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>'The scientific names of the species collected in this paper are Hemigrapsus nudus and Hemigrapsus orogenensis.'</code></pre>
</div>
</div>
<div id="d09afd68" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>result_reduce6a <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query6a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7af1ba47" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>result_reduce6a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>'The document does not provide information about the specific location where the species mentioned in the paper were collected from.'</code></pre>
</div>
</div>
<div id="64c5e8e3" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>result_reduce7 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query7, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0e0c89b1" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>result_reduce7[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>"I don't know. The document does not provide information about the specific locations where the species mentioned in the paper were observed or collected."</code></pre>
</div>
</div>
<div id="cf1413c9" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>result_reduce7a <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query7a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="aa67fbe1" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>result_reduce7a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>'The document does not provide information about the specific locations where the species mentioned in the paper were observed or collected.'</code></pre>
</div>
</div>
<div id="54be156a" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>result_reduce8 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query8, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bb990d54" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>result_reduce8[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>'No, the document does not provide any additional information about the specific locations where the species mentioned in the paper were observed or collected.'</code></pre>
</div>
</div>
<div id="b8dcf1d0" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>result_reduce9 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query9, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3de3974e" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>result_reduce9[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>'No, the document does not provide any latitude/longitude coordinate locations for the species mentioned in the paper.'</code></pre>
</div>
</div>
<div id="45f45981" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>result_reduce10 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query10, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a2e1ae12" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>result_reduce10[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>"I'm sorry, but based on the given portion of the document, there is no information available about the habitat in which the species mentioned in the paper were found."</code></pre>
</div>
</div>
<div id="2af906f2" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>result_reduce10a <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query10a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="049e00f8" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>result_reduce10a[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>'No, the document does not provide the formal name of the specific location where the habitat of the species mentioned in the paper was observed or collected.'</code></pre>
</div>
</div>
<div id="e3b017ee" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>result_reduce11 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query11, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8ee0f84e" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>result_reduce11[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>'The document does not provide any information about the year, date, or time that the species were collected or observed.'</code></pre>
</div>
</div>
<div id="80e8f464" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>result_reduce12 <span class="op">=</span> qa_chain_reduce({<span class="st">"question"</span>: query12, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="13342123" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>result_reduce12[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>'No, the paper does not contain any maps, figures, tables, or diagrams.'</code></pre>
</div>
</div>
</section>
<section id="conversationalretrievalchain-similarity-search-w-conversationbuffermemory" class="level1">
<h1><strong><em>ConversationalRetrievalChain Similarity Search w/ ConversationBufferMemory </em></strong></h1>
<div id="d15c715b" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>vector_store2 <span class="op">=</span> FAISS.from_texts(docs, embeddings).as_retriever(search_type <span class="op">=</span> <span class="st">"similarity"</span>, search_kwargs<span class="op">=</span> {<span class="st">"k"</span>: <span class="dv">3</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c70b75df" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>llm <span class="op">=</span> ChatOpenAI(temperature<span class="op">=</span><span class="dv">0</span>, model_name<span class="op">=</span><span class="st">'gpt-3.5-turbo'</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>compressor <span class="op">=</span> LLMChainExtractor.from_llm(llm)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>compression_retriever2 <span class="op">=</span> ContextualCompressionRetriever(base_compressor <span class="op">=</span> compressor,base_retriever<span class="op">=</span>vector_store2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="574e8865" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>custom_template <span class="op">=</span> <span class="st">"""Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question. Please use a maximum of 4 sentences. If you do not know the answer reply with 'I am sorry'.</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="st">1. SPECIES NAME: The scientific name (species name) of any plant, animal, fungus, alga or bacterium consists of two Latinized words. The first word is the name of the genus to which the organism belongs. The second word is the specific epithet or specific term of the species. Together, the genus plus the specific epithet make up the species name. The species name and scientific name are synonyms.</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="st">2. HABITAT: A species habitat can be seen as the physical manifestation of its ecological niche.</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="st">3. LOC: Name of any geographic location, like cities, countries, continents, districts etc.</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="st">Examples:</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="st">1. Sentence: Strongylocentrotus fransiscanus and S. purpuratus were obtained from the subtidal and intertidal regions, respectively, of Monterey Bay.</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="st">"Output: </span><span class="sc">{{</span><span class="st">'SPECIES NAME': ['Strongylocentrotus fransiscanus', 'S. purpuratus'], 'HABITAT': ['subtidal', 'intertidal'], 'LOC': ['Monterey Bay']</span><span class="sc">}}</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a><span class="st">2. Sentence: Cucumaria curata and C. pseudocurata live and feed in the hydrodynamically stressful environment of exposed intertidal areas.</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="st">Output: </span><span class="sc">{{</span><span class="st">'SPECIES NAME': ['Cucumaria curata', 'C. pseudocurata'], 'HABITAT': ['exposed intertidal'], 'LOC': ['None']</span><span class="sc">}}</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="st">Chat History:</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="sc">{chat_history}</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a><span class="st">Follow Up Input: </span><span class="sc">{question}</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="029f0ea3" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>CUSTOM_QUESTION_PROMPT <span class="op">=</span> PromptTemplate.from_template(custom_template)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2d1a27e5" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain.memory <span class="im">import</span> ConversationBufferMemory</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>memory <span class="op">=</span> ConversationBufferMemory(llm<span class="op">=</span>llm, input_key<span class="op">=</span><span class="st">'question'</span>, output_key<span class="op">=</span><span class="st">'answer'</span>,  return_messages<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="358332ae" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Formats the chat history string</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_chat_history(inputs) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> []</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> human, ai <span class="kw">in</span> inputs:</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>        res.append(<span class="ss">f"Human:</span><span class="sc">{</span>human<span class="sc">}</span><span class="ch">\n</span><span class="ss">AI:</span><span class="sc">{</span>ai<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="358ca388" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>qa_chain_2 <span class="op">=</span> ConversationalRetrievalChain.from_llm(ChatOpenAI(), </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>                                                 compression_retriever2,</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>                                                 memory <span class="op">=</span> memory,</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>                                                 return_source_documents <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>                                                 condense_question_prompt <span class="op">=</span> CUSTOM_QUESTION_PROMPT,</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>                                                 get_chat_history <span class="op">=</span> get_chat_history)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>                                                </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ce23e734" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"What is this paper about?"</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>query1a <span class="op">=</span> <span class="st">"What were the significant findings on the relationship mentioned?"</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>query2 <span class="op">=</span> <span class="st">"Summarize the paper concisely with reference to materials and methods."</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>query3 <span class="op">=</span> <span class="st">"Write a one sentence summary of the purpose of the paper"</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>query4 <span class="op">=</span> <span class="st">"Terms that may be used to identify an observation include “in the field”, “this study”, “observed”, “taken”, “collected”, “sampled”, “collection”, “seen”, “harvested”, “found”, etc. Does the paper include one or more observations?"</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>query5 <span class="op">=</span> <span class="st">"Does this paper contain observational or experimental research conducted in the natural environment or with organisms collected in nature?"</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>query6 <span class="op">=</span> <span class="st">"What are the scientific names of the collected species mentioned in this paper?"</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>query6a <span class="op">=</span> <span class="st">"Were there other species collected?"</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>query7 <span class="op">=</span> <span class="st">"Does the paper mention where the species were observed or collected, and if so, what locations are given?"</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>query7a <span class="op">=</span> <span class="st">"Please list the species collected based on their scientific names along with location of collection."</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>query8 <span class="op">=</span> <span class="st">"Can you give a more specific location?"</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>query9 <span class="op">=</span> <span class="st">"Are any coordinate locations given in latitude / longitude, and if so, what are they?"</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>query10 <span class="op">=</span> <span class="st">"In what habitat were the species found?"</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>query10a <span class="op">=</span> <span class="st">"Can you give a more specific location of the habitat such as formal name of said location?"</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>query11 <span class="op">=</span> <span class="st">"Does the paper mention a year, date and/or time that species were collected or observed, and if so, what was mentioned?"</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>query12 <span class="op">=</span> <span class="st">"Are there any maps, figures, tables or diagrams in the paper?"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="30161660" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>chat_history <span class="op">=</span> []</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="df57552a" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>result1b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4c16c475" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>result1b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>'This paper is about the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis, specifically focusing on the relationship between propus size and the use of snails as prey in sympatric populations. The paper explores the patterns and variations in propal height and width in male and female crabs of both species and examines the feeding preferences of the crabs for different types of snails. It also discusses the lack of difference in chela size between the two species and suggests that there is no character displacement in this trait.'</code></pre>
</div>
</div>
<div id="881eb5cc" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>result1b[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>[Document(page_content='Mean Consumption Rate  \n(Snails Consumed/Hour) \nIndividual H. nudus', metadata={}),
 Document(page_content='A few interesting patterns emerged in the morphometric analysis of Hemigrapsus nudus and Hemigrapsus orogenensis. The variance in propal height or propal width explained by carapace width was surprisingly high in female H. nudus with R2 values of 0.976 found for propal height and 0.927 for propal width. Male H. oregenensis had the greatest variation in chela size parameters, demonstrated by R2 of 0.693 and 0.534 for propal height and propal width respectively. The R2 values for propal width regressed against carapace width were consistently lower than propal height regressed against carapace width across species and sexes (Table 1). In general the ability of carapace width to explain the variance in chela size parameters (i.', metadata={}),
 Document(page_content='The relationship between propus size and use of snails as prey in sympatric populations \nof Hemigrapsus nudus and Hemigrapsus oregonensis was investigated. Propal height and propal \nwidth increases with body size in a predictable manner in male and female crabs of both species. \nSexual dimorphism of propal height and width relationships in both shore crabs is apparent, but \nthere was no detectible difference in chela size between H. nudus and H. oregonensis. The lack \nof difference in chela size between sympatric H. nudus and H. oregonensis suggests that there is \nno character displacement in this trait. Both species of crabs showed a strong feeding preference \nfor the thin-shelled gastropod Lacuna vincta over the thicker shelled Littorina scutulata, likely \ndue to the ease of consumption. There were no differences in snail consumption rates between \nmale and female H. nudus of similar propal heights, mostly due to high feeding variation among \nindividual crabs.', metadata={})]</code></pre>
</div>
</div>
<div id="7ee2a0c6" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>result1b[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>[]</code></pre>
</div>
</div>
<div id="d58154e8" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>result2b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query2, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="01daf472" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>result2b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>'The paper examined the relationship between carapace width and chela size in two species of shore crabs, Hemigrapsus nudus and Hemigrapsus oregonensis. The study focused on both females and males of the two species. The authors used a two-way ANOVA with factors sex and species to analyze the data. They also performed an arcsin transformation due to non-normality of certain variables. The results showed that carapace width was a good predictor of propal height and propal width in both female and male crabs. There was no significant difference in chela size between the two species. However, a significant sex*species interaction was found. The study suggests that trade-offs between claw size and factors like feeding efficiency or resource allocation may explain the variation in chela size.'</code></pre>
</div>
</div>
<div id="cc42f6fe" class="cell" data-scrolled="true" data-execution_count="102">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>result2b[<span class="st">"source_documents"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>[Document(page_content='apace width were consistently \nlower than propal height regressed against carapace width across species and sexes (Table 1). In \ngeneral the ability of carapace width to explain the variance in chela size parameters (i.e.: R2 \nvalues) was greater in females of both crab species (Table 1, Figures 1 and 2). Males may have \nmore variation in claw size due to trade-offs between claw size and factors like feeding \nefficiency or resource allocation. Trade-offs relating to chela size are found in fiddler crabs, \nwhich exhibit extreme sexual dimorphism. Fiddler crabs have a trade-off between the intrasexual \ncompetition and intersexual signaling functions of the dimorphic claw (Swanson et al. 2013). \nCharifson 8 \n \nThis is not to say that the particular trade-offs in fiddler crabs case are analogous to that of \nHemigrapsus, since both claws in the two shore crabs in this study are used in feeding.  \nSexual dimorphism in chela size, which is readily apparent to the eye in both \nHemigrapsus nudus and Hemigrapsus oregonensis, was detected statistically (Figures 3 and 4). \nThe two-way ANOVA with factors sex and species did not show a significant species effect, \nsuggesting that the claws of both shore crabs produce roughly the same force and are \nfunctionally equivalent (Behrens Yamada and Boulding 1998). The lack of morphological \ndifference in the size of the chelae between the crab species removes the possibility of character \ndisplacement in the trait. It should be noted that this study was not designed to test for character \ndisplacement, but to determine if this would be an interesting question for future investigations. \nTo make a compelling case for character displacement it is necessary to compare multiple \nsympatric and allopatric populations with similar abiotic and biotic conditions (Stuart and Losos \n2013). Also it must be demonstrated that the trait differs due to genetic differences between \nsympatric and allopatric populations, that the differences between the populations are not due to \nspecies sorting, that the morphological trait is correlated to differences in resource use between \nthe two sympatric species, and that the similar phenotype in allopatric populations compete for \nthe same resources (Stuart and Losos 2013). The tendency of H. nudus to occupy the upper \nintertidal zone (Sliger 1987), despite considerable overlap with H. oregonensis, may provide \nenough differential resource use to prevent exclusion in sympatry. Desiccation tolerance may be \na better trait to test for character displacement in these shore crabs.', metadata={}),
 Document(page_content='ace width was a good predictor of both propal height (Figure 1, Table 1A) and \npropal width (Figure 2, Table 1B) in female and male H. oregonensis and H. nudus. There was \nless variation in the relationship between carapace width and propal height than with propal \nwidth.  Due to non-normality of CW:PH and CW:PW an arcsin transformation was used. A \nsignificant effect for sex was found for both CW:PH (F1, 45 = 125.6, p &lt; 0.001) and CW:PW  (F1, \n45 = 103.81, p &lt; 0.001). There was no significant difference between Hemigrapsus species for \nCW:PH (F1, 45 &lt; 0.01, p = 0.983) and CW:PW (F1, 45 = 0.09, p = 0.764). A significant \nsex*species interaction was detected for both CW:PH (F1, 45 4.39, p = 0.042) and CW:PW (F1, 45 \n= 7.19, p = 0.010). Figure 3 and 4 show the means of CW:PH and CW:PW in by sex and species \nrespectively.', metadata={})]</code></pre>
</div>
</div>
<div id="60144f50" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>result2b[<span class="st">"chat_history"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>[]</code></pre>
</div>
</div>
<div id="5b5362e9" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>result3b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query3, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d1298828" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>result3b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>'The purpose of the paper was to investigate the relationship between propus size and the use of snails as prey in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis, and to determine if there was any character displacement in chela size between the two species.'</code></pre>
</div>
</div>
<div id="2c647ec5" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>result4b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query4, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2486f93f" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>result4b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>'Yes, the paper includes several observations. It mentions the collection of una vincta and Littorina scutulata from different locations, the absence of detectable differences in chela size between H. nudus and H. oregonensis, and the feeding preference of both crab species for Lacuna vincta over Littorina scutulata. It also states that there were no differences in snail consumption rates between male and female H. nudus of similar propal heights.'</code></pre>
</div>
</div>
<div id="8553b20a" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>result5b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query5, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e046234f" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>result5b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>"Based on the given context, it appears that the research described in the paper is observational in nature. The crabs' feeding preferences and snail consumption rates were observed in sympatric populations of Hemigrapsus nudus and Hemigrapsus oregonensis. Snails were collected from different locations in the natural environment, suggesting that the research involved organisms collected in nature."</code></pre>
</div>
</div>
<div id="f922654b" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>result6b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query6, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3041ace7" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>result6b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>'The scientific names of the collected species mentioned in this paper are:\n\n- Lacuna vincta\n- Littorina scutulata\n- Hemigrapsus nudus\n- Hemigrapsus oregonensis'</code></pre>
</div>
</div>
<div id="30eb4b04" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>result7b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query7, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="88ff25d9" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>result7b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>'Yes, the paper mentions the locations where the species were collected. Lacuna vincta was collected at False Bay and Dead Man Cove, while Littorina scutulata was collected from the rocky intertidal zone of Fourth of July Beach.'</code></pre>
</div>
</div>
<div id="6f8c21d6" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>result7c <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query7a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1d7bdcd0" class="cell" data-scrolled="true" data-execution_count="106">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>result7c[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>'Based on the given information, the species collected and their respective locations are:\n\n1. Lacuna vincta - Collected at False Bay and Dead Man Cove.\n2. Littorina scutulata - Collected from the rocky intertidal zone of Fourth of July Beach.\n3. Hemigrapsus nudus - No information provided about the location of collection.\n4. Hemigrapsus oregonensis - No information provided about the location of collection.'</code></pre>
</div>
</div>
<div id="d29ed50a" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>result8b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query8, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2031f59f" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>result8b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>'Yes, the specific locations mentioned in the context are False Bay, Dead Man Cove, and Fourth of July Beach.'</code></pre>
</div>
</div>
<div id="0e2005b2" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>result9b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query9, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="be466ca0" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>result9b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>"I'm sorry, but I don't have access to any specific coordinate locations in latitude/longitude at the moment."</code></pre>
</div>
</div>
<div id="ed56a515" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>result10b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query10, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a2bd63af" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>result10b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>'The species una vincta and Littorina scutulata were found in the rocky intertidal zone at False Bay, Dead Man Cove, and Fourth of July Beach on San Juan Island, Washington. The shore crabs Hemigrapsus oregonensis and Hemigrapsus nudus were collected in the intertidal zone adjacent to the Friday Harbor Laboratories dock.'</code></pre>
</div>
</div>
<div id="b5e8ce94" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>result10c <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query10a, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="30e651a3" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>result10c[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>'The specific location mentioned in the context is San Juan Island, Washington. However, the context does not provide any formal names of the habitats or locations where the specimens were collected.'</code></pre>
</div>
</div>
<div id="1b8eff68" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>result11b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query11, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="97f61340" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>result11b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>'Yes, the paper mentions the year as "Summer 2014". However, it does not mention a specific date or time when the species were collected or observed.'</code></pre>
</div>
</div>
<div id="2dfbd0f2" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>result12b <span class="op">=</span> qa_chain_2({<span class="st">"question"</span>: query12, <span class="st">"chat_history"</span>: chat_history})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7197b695" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>result12b[<span class="st">"answer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>'Yes, there are figures and tables in the paper. Specifically, there are Figure 1, Table 1A, Figure 2, Table 1B, Figure 3, and Figure 4.'</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Miller-Library\.github\.io\/taxa-project\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© CC-1.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/Miller-Library/taxa_webV2/blob/main/Option #2 Experiment/Option #2A Refinement.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/Miller-Library/taxa_webV2/blob/main/Option #2 Experiment/Option #2A Refinement.ipynb" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/Miller-Library/taxa_webV2/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>